Run training...
Experiment dir : /m/triton/scratch/elec/puhe/p/jaina5/transformer-xl/FinnishXL/-Ktrain/20191107-140053
Loading cached dataset...
====================================================================================================
    - data : /m/triton/scratch/elec/puhe/p/jaina5/transformer-xl/FinnishXL/data/kiel_data/
    - dataset : Ktrain
    - n_layer : 96
    - n_head : 8
    - d_head : 40
    - d_embed : 256
    - d_model : 256
    - d_inner : 1024
    - dropout : 0.05
    - dropatt : 0.05
    - init : normal
    - emb_init : normal
    - init_range : 0.1
    - emb_init_range : 0.01
    - init_std : 0.02
    - proj_init_std : 0.01
    - optim : adam
    - lr : 0.00025
    - mom : 0.0
    - scheduler : cosine
    - warmup_step : 0
    - decay_rate : 0.5
    - lr_min : 0.0
    - clip : 0.25
    - clip_nonemb : False
    - max_step : 200000
    - batch_size : 512
    - batch_chunk : 4
    - tgt_len : 32
    - eval_tgt_len : 32
    - ext_len : 0
    - mem_len : 32
    - not_tied : False
    - seed : 1111
    - cuda : True
    - adaptive : False
    - div_val : 1
    - pre_lnorm : False
    - varlen : False
    - multi_gpu : False
    - log_interval : 200
    - eval_interval : 4000
    - work_dir : /m/triton/scratch/elec/puhe/p/jaina5/transformer-xl/FinnishXL/-Ktrain/20191107-140053
    - restart : True
    - restart_dir : /m/triton/scratch/elec/puhe/p/jaina5/transformer-xl/FinnishXL/-Ktrain/20191105-144617
    - debug : False
    - same_length : False
    - attn_type : 0
    - clamp_len : -1
    - eta_min : 0.0
    - gpu0_bsz : -1
    - max_eval_steps : -1
    - sample_softmax : -1
    - patience : 0
    - finetune_v2 : False
    - finetune_v3 : False
    - fp16 : False
    - static_loss_scale : 1
    - dynamic_loss_scale : False
    - tied : True
    - n_token : 34519
    - n_all_param : 98746455
    - n_nonemb_param : 89874432
====================================================================================================
#params = 98746455
#non emb params = 89874432
| epoch   1 step      200 |    200 batches | lr 0 | ms/batch 2633.53 | loss  3.72 | ppl    41.325
| epoch   1 step      400 |    400 batches | lr 0 | ms/batch 2639.90 | loss  3.73 | ppl    41.483
| epoch   1 step      600 |    600 batches | lr 0 | ms/batch 2645.25 | loss  3.73 | ppl    41.544
| epoch   1 step      800 |    800 batches | lr 0 | ms/batch 2645.92 | loss  3.72 | ppl    41.426
| epoch   1 step     1000 |   1000 batches | lr 0 | ms/batch 2644.71 | loss  3.73 | ppl    41.619
| epoch   1 step     1200 |   1200 batches | lr 0 | ms/batch 2643.15 | loss  3.72 | ppl    41.425
| epoch   1 step     1400 |   1400 batches | lr 0 | ms/batch 2642.93 | loss  3.73 | ppl    41.576
| epoch   1 step     1600 |   1600 batches | lr 0 | ms/batch 2642.15 | loss  3.73 | ppl    41.718
| epoch   1 step     1800 |   1800 batches | lr 0 | ms/batch 2643.57 | loss  3.73 | ppl    41.687
| epoch   1 step     2000 |   2000 batches | lr 0 | ms/batch 2645.90 | loss  3.73 | ppl    41.717
| epoch   1 step     2200 |   2200 batches | lr 0 | ms/batch 2642.79 | loss  3.73 | ppl    41.531
| epoch   1 step     2400 |   2400 batches | lr 0 | ms/batch 2641.92 | loss  3.73 | ppl    41.705
| epoch   1 step     2600 |   2600 batches | lr 0 | ms/batch 2642.74 | loss  3.73 | ppl    41.839
| epoch   1 step     2800 |   2800 batches | lr 0 | ms/batch 2641.11 | loss  3.73 | ppl    41.675
| epoch   1 step     3000 |   3000 batches | lr 0 | ms/batch 2657.49 | loss  3.73 | ppl    41.586
| epoch   1 step     3200 |   3200 batches | lr 0 | ms/batch 2649.53 | loss  3.73 | ppl    41.759
| epoch   1 step     3400 |   3400 batches | lr 0 | ms/batch 2663.64 | loss  3.73 | ppl    41.854
| epoch   1 step     3600 |   3600 batches | lr 0 | ms/batch 2655.99 | loss  3.73 | ppl    41.575
| epoch   1 step     3800 |   3800 batches | lr 0 | ms/batch 2670.04 | loss  3.73 | ppl    41.690
| epoch   1 step     4000 |   4000 batches | lr 0 | ms/batch 2672.25 | loss  3.73 | ppl    41.627
----------------------------------------------------------------------------------------------------
| Eval   1 at step     4000 | time: 11362.03s | valid loss  3.76 | valid ppl    43.094
----------------------------------------------------------------------------------------------------
| epoch   1 step     4200 |   4200 batches | lr 0 | ms/batch 6518.92 | loss  3.73 | ppl    41.520
| epoch   1 step     4400 |   4400 batches | lr 0 | ms/batch 2673.87 | loss  3.73 | ppl    41.766
| epoch   1 step     4600 |   4600 batches | lr 0 | ms/batch 2668.73 | loss  3.74 | ppl    41.926
| epoch   1 step     4800 |   4800 batches | lr 0 | ms/batch 2668.51 | loss  3.73 | ppl    41.712
| epoch   1 step     5000 |   5000 batches | lr 0 | ms/batch 2646.92 | loss  3.73 | ppl    41.541
| epoch   1 step     5200 |   5200 batches | lr 0 | ms/batch 2637.78 | loss  3.73 | ppl    41.594
| epoch   1 step     5400 |   5400 batches | lr 0 | ms/batch 2637.77 | loss  3.73 | ppl    41.618
| epoch   1 step     5600 |   5600 batches | lr 0 | ms/batch 2637.21 | loss  3.73 | ppl    41.644
| epoch   1 step     5800 |   5800 batches | lr 0 | ms/batch 2638.39 | loss  3.73 | ppl    41.629
| epoch   1 step     6000 |   6000 batches | lr 0 | ms/batch 2638.64 | loss  3.73 | ppl    41.798
| epoch   1 step     6200 |   6200 batches | lr 0 | ms/batch 2634.01 | loss  3.73 | ppl    41.733
| epoch   1 step     6400 |   6400 batches | lr 0 | ms/batch 2636.99 | loss  3.73 | ppl    41.602
| epoch   1 step     6600 |   6600 batches | lr 0 | ms/batch 2637.89 | loss  3.73 | ppl    41.813
| epoch   1 step     6800 |   6800 batches | lr 0 | ms/batch 2637.67 | loss  3.73 | ppl    41.808
| epoch   1 step     7000 |   7000 batches | lr 0 | ms/batch 2636.81 | loss  3.73 | ppl    41.669
| epoch   1 step     7200 |   7200 batches | lr 0 | ms/batch 2636.94 | loss  3.72 | ppl    41.440
| epoch   1 step     7400 |   7400 batches | lr 0 | ms/batch 2637.25 | loss  3.73 | ppl    41.647
| epoch   1 step     7600 |   7600 batches | lr 0 | ms/batch 2635.81 | loss  3.73 | ppl    41.823
| epoch   1 step     7800 |   7800 batches | lr 0 | ms/batch 2632.25 | loss  3.73 | ppl    41.720
| epoch   1 step     8000 |   8000 batches | lr 0 | ms/batch 2633.80 | loss  3.73 | ppl    41.669
----------------------------------------------------------------------------------------------------
| Eval   2 at step     8000 | time: 11289.96s | valid loss  3.76 | valid ppl    43.094
----------------------------------------------------------------------------------------------------
| epoch   1 step     8200 |   8200 batches | lr 0 | ms/batch 6210.67 | loss  3.73 | ppl    41.751
| epoch   1 step     8400 |   8400 batches | lr 0 | ms/batch 2633.47 | loss  3.73 | ppl    41.864
| epoch   1 step     8600 |   8600 batches | lr 0 | ms/batch 2633.73 | loss  3.73 | ppl    41.707
| epoch   1 step     8800 |   8800 batches | lr 0 | ms/batch 2634.42 | loss  3.73 | ppl    41.590
| epoch   1 step     9000 |   9000 batches | lr 0 | ms/batch 2636.12 | loss  3.72 | ppl    41.467
| epoch   1 step     9200 |   9200 batches | lr 0 | ms/batch 2639.65 | loss  3.73 | ppl    41.821
| epoch   1 step     9400 |   9400 batches | lr 0 | ms/batch 2641.23 | loss  3.73 | ppl    41.884
| epoch   1 step     9600 |   9600 batches | lr 0 | ms/batch 2637.75 | loss  3.73 | ppl    41.734
| epoch   1 step     9800 |   9800 batches | lr 0 | ms/batch 2637.51 | loss  3.73 | ppl    41.827
| epoch   1 step    10000 |  10000 batches | lr 0 | ms/batch 2638.93 | loss  3.73 | ppl    41.672
| epoch   1 step    10200 |  10200 batches | lr 0 | ms/batch 2637.71 | loss  3.73 | ppl    41.875
| epoch   1 step    10400 |  10400 batches | lr 0 | ms/batch 2637.93 | loss  3.73 | ppl    41.838
| epoch   1 step    10600 |  10600 batches | lr 0 | ms/batch 2637.70 | loss  3.73 | ppl    41.769
| epoch   1 step    10800 |  10800 batches | lr 0 | ms/batch 2638.65 | loss  3.73 | ppl    41.772
| epoch   1 step    11000 |  11000 batches | lr 0 | ms/batch 2638.46 | loss  3.74 | ppl    42.199
| epoch   1 step    11200 |  11200 batches | lr 0 | ms/batch 2637.49 | loss  3.73 | ppl    41.656
| epoch   1 step    11400 |  11400 batches | lr 0 | ms/batch 2637.29 | loss  3.74 | ppl    41.971
| epoch   1 step    11600 |  11600 batches | lr 0 | ms/batch 2637.55 | loss  3.73 | ppl    41.639
| epoch   1 step    11800 |  11800 batches | lr 0 | ms/batch 2637.98 | loss  3.73 | ppl    41.786
| epoch   1 step    12000 |  12000 batches | lr 0 | ms/batch 2637.83 | loss  3.74 | ppl    41.984
----------------------------------------------------------------------------------------------------
| Eval   3 at step    12000 | time: 11259.15s | valid loss  3.76 | valid ppl    43.094
----------------------------------------------------------------------------------------------------
| epoch   1 step    12200 |  12200 batches | lr 0 | ms/batch 6188.63 | loss  3.74 | ppl    41.913
| epoch   1 step    12400 |  12400 batches | lr 0 | ms/batch 2640.29 | loss  3.74 | ppl    42.018
| epoch   1 step    12600 |  12600 batches | lr 0 | ms/batch 2640.24 | loss  3.73 | ppl    41.885
| epoch   1 step    12800 |  12800 batches | lr 0 | ms/batch 2640.27 | loss  3.74 | ppl    42.257
| epoch   1 step    13000 |  13000 batches | lr 0 | ms/batch 2638.35 | loss  3.73 | ppl    41.674
| epoch   1 step    13200 |  13200 batches | lr 0 | ms/batch 2632.92 | loss  3.73 | ppl    41.747
| epoch   1 step    13400 |  13400 batches | lr 0 | ms/batch 2623.92 | loss  3.74 | ppl    41.909
| epoch   1 step    13600 |  13600 batches | lr 0 | ms/batch 2623.76 | loss  3.74 | ppl    42.039
| epoch   1 step    13800 |  13800 batches | lr 0 | ms/batch 2623.78 | loss  3.74 | ppl    41.990
| epoch   1 step    14000 |  14000 batches | lr 0 | ms/batch 2622.64 | loss  3.74 | ppl    42.100
| epoch   1 step    14200 |  14200 batches | lr 0 | ms/batch 2623.02 | loss  3.74 | ppl    41.924
| epoch   1 step    14400 |  14400 batches | lr 0 | ms/batch 2623.34 | loss  3.74 | ppl    42.116
| epoch   1 step    14600 |  14600 batches | lr 0 | ms/batch 2622.93 | loss  3.74 | ppl    41.986
| epoch   1 step    14800 |  14800 batches | lr 0 | ms/batch 2623.92 | loss  3.74 | ppl    42.057
| epoch   1 step    15000 |  15000 batches | lr 0 | ms/batch 2635.04 | loss  3.74 | ppl    42.076
| epoch   2 step    15200 |     85 batches | lr 0 | ms/batch 2640.49 | loss  3.74 | ppl    42.031
| epoch   2 step    15400 |    285 batches | lr 0 | ms/batch 2632.36 | loss  3.73 | ppl    41.581
| epoch   2 step    15600 |    485 batches | lr 0 | ms/batch 2622.19 | loss  3.73 | ppl    41.615
| epoch   2 step    15800 |    685 batches | lr 0 | ms/batch 2624.40 | loss  3.74 | ppl    41.969
| epoch   2 step    16000 |    885 batches | lr 0 | ms/batch 2626.09 | loss  3.73 | ppl    41.657
----------------------------------------------------------------------------------------------------
| Eval   4 at step    16000 | time: 11220.35s | valid loss  3.76 | valid ppl    43.094
----------------------------------------------------------------------------------------------------
| epoch   2 step    16200 |   1085 batches | lr 0 | ms/batch 6139.09 | loss  3.73 | ppl    41.801
| epoch   2 step    16400 |   1285 batches | lr 0 | ms/batch 2637.36 | loss  3.73 | ppl    41.764
| epoch   2 step    16600 |   1485 batches | lr 0 | ms/batch 2636.42 | loss  3.74 | ppl    41.901
| epoch   2 step    16800 |   1685 batches | lr 0 | ms/batch 2639.46 | loss  3.73 | ppl    41.507
| epoch   2 step    17000 |   1885 batches | lr 0 | ms/batch 2631.20 | loss  3.73 | ppl    41.736
| epoch   2 step    17200 |   2085 batches | lr 0 | ms/batch 2638.02 | loss  3.74 | ppl    41.965
| epoch   2 step    17400 |   2285 batches | lr 0 | ms/batch 2636.86 | loss  3.74 | ppl    41.888
| epoch   2 step    17600 |   2485 batches | lr 0 | ms/batch 2638.22 | loss  3.74 | ppl    42.033
| epoch   2 step    17800 |   2685 batches | lr 0 | ms/batch 2640.54 | loss  3.73 | ppl    41.728
| epoch   2 step    18000 |   2885 batches | lr 0 | ms/batch 2641.34 | loss  3.73 | ppl    41.679
| epoch   2 step    18200 |   3085 batches | lr 0 | ms/batch 2629.66 | loss  3.74 | ppl    42.041
| epoch   2 step    18400 |   3285 batches | lr 0 | ms/batch 2639.16 | loss  3.74 | ppl    41.934
| epoch   2 step    18600 |   3485 batches | lr 0 | ms/batch 2639.55 | loss  3.74 | ppl    42.114
| epoch   2 step    18800 |   3685 batches | lr 0 | ms/batch 2640.24 | loss  3.74 | ppl    41.930
| epoch   2 step    19000 |   3885 batches | lr 0 | ms/batch 2631.44 | loss  3.74 | ppl    41.931
| epoch   2 step    19200 |   4085 batches | lr 0 | ms/batch 2623.36 | loss  3.74 | ppl    41.996
| epoch   2 step    19400 |   4285 batches | lr 0 | ms/batch 2632.58 | loss  3.74 | ppl    42.072
| epoch   2 step    19600 |   4485 batches | lr 0 | ms/batch 2627.00 | loss  3.74 | ppl    42.044
| epoch   2 step    19800 |   4685 batches | lr 0 | ms/batch 2622.83 | loss  3.74 | ppl    42.011
| epoch   2 step    20000 |   4885 batches | lr 0 | ms/batch 2622.89 | loss  3.73 | ppl    41.802
----------------------------------------------------------------------------------------------------
| Eval   5 at step    20000 | time: 11226.54s | valid loss  3.76 | valid ppl    43.094
----------------------------------------------------------------------------------------------------
| epoch   2 step    20200 |   5085 batches | lr 0 | ms/batch 6076.10 | loss  3.74 | ppl    42.056
| epoch   2 step    20400 |   5285 batches | lr 0 | ms/batch 2622.75 | loss  3.74 | ppl    42.225
| epoch   2 step    20600 |   5485 batches | lr 0 | ms/batch 2622.19 | loss  3.74 | ppl    42.076
| epoch   2 step    20800 |   5685 batches | lr 0 | ms/batch 2622.81 | loss  3.74 | ppl    42.213
| epoch   2 step    21000 |   5885 batches | lr 0 | ms/batch 2622.47 | loss  3.73 | ppl    41.840
| epoch   2 step    21200 |   6085 batches | lr 0 | ms/batch 2622.13 | loss  3.74 | ppl    42.225
| epoch   2 step    21400 |   6285 batches | lr 0 | ms/batch 2622.69 | loss  3.74 | ppl    42.126
| epoch   2 step    21600 |   6485 batches | lr 0 | ms/batch 2630.00 | loss  3.74 | ppl    42.060
| epoch   2 step    21800 |   6685 batches | lr 0 | ms/batch 2626.14 | loss  3.74 | ppl    41.945
| epoch   2 step    22000 |   6885 batches | lr 0 | ms/batch 2622.82 | loss  3.74 | ppl    42.027
| epoch   2 step    22200 |   7085 batches | lr 0 | ms/batch 2622.64 | loss  3.75 | ppl    42.450
| epoch   2 step    22400 |   7285 batches | lr 0 | ms/batch 2625.32 | loss  3.75 | ppl    42.444
| epoch   2 step    22600 |   7485 batches | lr 0 | ms/batch 2622.65 | loss  3.74 | ppl    42.274
| epoch   2 step    22800 |   7685 batches | lr 0 | ms/batch 2634.08 | loss  3.74 | ppl    41.956
| epoch   2 step    23000 |   7885 batches | lr 0 | ms/batch 2622.27 | loss  3.74 | ppl    42.069
| epoch   2 step    23200 |   8085 batches | lr 0 | ms/batch 2622.42 | loss  3.74 | ppl    42.122
| epoch   2 step    23400 |   8285 batches | lr 0 | ms/batch 2623.23 | loss  3.73 | ppl    41.846
| epoch   2 step    23600 |   8485 batches | lr 0 | ms/batch 2622.79 | loss  3.74 | ppl    42.216
| epoch   2 step    23800 |   8685 batches | lr 0 | ms/batch 2623.73 | loss  3.74 | ppl    42.195
| epoch   2 step    24000 |   8885 batches | lr 0 | ms/batch 2629.35 | loss  3.74 | ppl    41.945
----------------------------------------------------------------------------------------------------
| Eval   6 at step    24000 | time: 11201.29s | valid loss  3.76 | valid ppl    43.094
----------------------------------------------------------------------------------------------------
| epoch   2 step    24200 |   9085 batches | lr 0 | ms/batch 6145.52 | loss  3.74 | ppl    42.277
| epoch   2 step    24400 |   9285 batches | lr 0 | ms/batch 2636.80 | loss  3.74 | ppl    42.265
| epoch   2 step    24600 |   9485 batches | lr 0 | ms/batch 2640.22 | loss  3.74 | ppl    41.993
| epoch   2 step    24800 |   9685 batches | lr 0 | ms/batch 2639.62 | loss  3.74 | ppl    42.109
| epoch   2 step    25000 |   9885 batches | lr 0 | ms/batch 2636.18 | loss  3.74 | ppl    41.990
| epoch   2 step    25200 |  10085 batches | lr 0 | ms/batch 2622.43 | loss  3.74 | ppl    42.049
| epoch   2 step    25400 |  10285 batches | lr 0 | ms/batch 2623.15 | loss  3.74 | ppl    42.298
| epoch   2 step    25600 |  10485 batches | lr 0 | ms/batch 2622.79 | loss  3.74 | ppl    41.994
| epoch   2 step    25800 |  10685 batches | lr 0 | ms/batch 2626.49 | loss  3.75 | ppl    42.318
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
slurmstepd: error: *** JOB 47476635 ON gpu10 CANCELLED AT 2019-11-08T14:31:41 ***
slurmstepd: error: *** STEP 47476635.0 ON gpu10 CANCELLED AT 2019-11-08T14:31:41 ***
