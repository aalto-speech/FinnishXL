Run training...
Experiment dir : /scratch/elec/puhe/p/jaina5/transformer-xl/FinnishXL/-Ktrain/20200408-140020
Loading cached dataset...
====================================================================================================
    - data : /m/triton/scratch/elec/puhe/p/jaina5/transformer-xl/FinnishXL/data/kiel_data/
    - dataset : Ktrain
    - n_layer : 18
    - n_head : 8
    - d_head : 128
    - d_embed : 1024
    - d_model : 1024
    - d_inner : 4096
    - dropout : 0.0
    - dropatt : 0.0
    - init : normal
    - emb_init : normal
    - init_range : 0.1
    - emb_init_range : 0.01
    - init_std : 0.02
    - proj_init_std : 0.01
    - optim : adam
    - lr : 0.00025
    - mom : 0.0
    - scheduler : cosine
    - warmup_step : 20000
    - decay_rate : 0.5
    - lr_min : 0.0
    - clip : 0.25
    - clip_nonemb : False
    - max_step : 500000
    - batch_size : 224
    - batch_chunk : 4
    - tgt_len : 32
    - eval_tgt_len : 32
    - ext_len : 0
    - mem_len : 32
    - not_tied : False
    - seed : 1111
    - cuda : True
    - adaptive : False
    - div_val : 1
    - pre_lnorm : False
    - varlen : False
    - multi_gpu : False
    - log_interval : 200
    - eval_interval : 4000
    - work_dir : /scratch/elec/puhe/p/jaina5/transformer-xl/FinnishXL/-Ktrain/20200408-140020
    - restart : False
    - restart_dir : 
    - debug : False
    - same_length : False
    - attn_type : 0
    - clamp_len : -1
    - eta_min : 0.0
    - gpu0_bsz : -1
    - max_eval_steps : -1
    - sample_softmax : -1
    - patience : 0
    - finetune_v2 : False
    - finetune_v3 : False
    - fp16 : False
    - static_loss_scale : 1
    - dynamic_loss_scale : False
    - tied : True
    - n_token : 34519
    - n_all_param : 280916695
    - n_nonemb_param : 245532672
====================================================================================================
#params = 280916695
#non emb params = 245532672
| epoch   1 step      200 |    200 batches | lr 2.5e-06 | ms/batch 1415.31 | loss  9.72 | ppl 16631.354
| epoch   1 step      400 |    400 batches | lr 5e-06 | ms/batch 1417.19 | loss  9.10 | ppl  8953.353
| epoch   1 step      600 |    600 batches | lr 7.5e-06 | ms/batch 1423.00 | loss  8.44 | ppl  4648.536
| epoch   1 step      800 |    800 batches | lr 1e-05 | ms/batch 1424.08 | loss  7.99 | ppl  2944.871
| epoch   1 step     1000 |   1000 batches | lr 1.25e-05 | ms/batch 1425.76 | loss  7.65 | ppl  2100.825
| epoch   1 step     1200 |   1200 batches | lr 1.5e-05 | ms/batch 1425.82 | loss  7.38 | ppl  1598.617
| epoch   1 step     1400 |   1400 batches | lr 1.75e-05 | ms/batch 1425.94 | loss  7.16 | ppl  1284.005
| epoch   1 step     1600 |   1600 batches | lr 2e-05 | ms/batch 1426.57 | loss  6.94 | ppl  1035.989
| epoch   1 step     1800 |   1800 batches | lr 2.25e-05 | ms/batch 1426.26 | loss  6.77 | ppl   874.860
| epoch   1 step     2000 |   2000 batches | lr 2.5e-05 | ms/batch 1425.90 | loss  6.61 | ppl   743.411
| epoch   1 step     2200 |   2200 batches | lr 2.75e-05 | ms/batch 1426.03 | loss  6.47 | ppl   648.496
| epoch   1 step     2400 |   2400 batches | lr 3e-05 | ms/batch 1427.02 | loss  6.37 | ppl   582.616
| epoch   1 step     2600 |   2600 batches | lr 3.25e-05 | ms/batch 1426.24 | loss  6.23 | ppl   507.627
| epoch   1 step     2800 |   2800 batches | lr 3.5e-05 | ms/batch 1425.45 | loss  6.11 | ppl   450.071
| epoch   1 step     3000 |   3000 batches | lr 3.75e-05 | ms/batch 1426.14 | loss  6.02 | ppl   410.566
| epoch   1 step     3200 |   3200 batches | lr 4e-05 | ms/batch 1426.22 | loss  5.94 | ppl   378.647
| epoch   1 step     3400 |   3400 batches | lr 4.25e-05 | ms/batch 1425.87 | loss  5.84 | ppl   344.199
| epoch   1 step     3600 |   3600 batches | lr 4.5e-05 | ms/batch 1424.46 | loss  5.86 | ppl   350.640
| epoch   1 step     3800 |   3800 batches | lr 4.75e-05 | ms/batch 1425.07 | loss  5.76 | ppl   315.852
| epoch   1 step     4000 |   4000 batches | lr 5e-05 | ms/batch 1424.79 | loss  5.71 | ppl   301.880
----------------------------------------------------------------------------------------------------
| Eval   1 at step     4000 | time: 5952.17s | valid loss  5.79 | valid ppl   326.616
----------------------------------------------------------------------------------------------------
| epoch   1 step     4200 |   4200 batches | lr 5.25e-05 | ms/batch 2729.13 | loss  5.65 | ppl   285.249
| epoch   1 step     4400 |   4400 batches | lr 5.5e-05 | ms/batch 1425.06 | loss  5.61 | ppl   273.866
| epoch   1 step     4600 |   4600 batches | lr 5.75e-05 | ms/batch 1423.67 | loss  5.49 | ppl   241.475
| epoch   1 step     4800 |   4800 batches | lr 6e-05 | ms/batch 1423.62 | loss  5.40 | ppl   221.424
| epoch   1 step     5000 |   5000 batches | lr 6.25e-05 | ms/batch 1424.23 | loss  5.38 | ppl   217.755
| epoch   1 step     5200 |   5200 batches | lr 6.5e-05 | ms/batch 1423.65 | loss  5.32 | ppl   203.562
| epoch   1 step     5400 |   5400 batches | lr 6.75e-05 | ms/batch 1423.18 | loss  5.28 | ppl   196.848
| epoch   1 step     5600 |   5600 batches | lr 7e-05 | ms/batch 1424.02 | loss  5.24 | ppl   189.150
| epoch   1 step     5800 |   5800 batches | lr 7.25e-05 | ms/batch 1422.54 | loss  5.23 | ppl   186.172
| epoch   1 step     6000 |   6000 batches | lr 7.5e-05 | ms/batch 1423.41 | loss  5.10 | ppl   163.912
| epoch   1 step     6200 |   6200 batches | lr 7.75e-05 | ms/batch 1424.83 | loss  5.23 | ppl   186.017
| epoch   1 step     6400 |   6400 batches | lr 8e-05 | ms/batch 1424.19 | loss  5.02 | ppl   151.579
| epoch   1 step     6600 |   6600 batches | lr 8.25e-05 | ms/batch 1423.72 | loss  4.92 | ppl   137.567
| epoch   1 step     6800 |   6800 batches | lr 8.5e-05 | ms/batch 1427.68 | loss  4.98 | ppl   145.648
| epoch   1 step     7000 |   7000 batches | lr 8.75e-05 | ms/batch 1424.30 | loss  4.81 | ppl   122.337
| epoch   1 step     7200 |   7200 batches | lr 9e-05 | ms/batch 1426.12 | loss  4.89 | ppl   132.951
| epoch   1 step     7400 |   7400 batches | lr 9.25e-05 | ms/batch 1423.70 | loss  4.81 | ppl   123.233
| epoch   1 step     7600 |   7600 batches | lr 9.5e-05 | ms/batch 1424.77 | loss  4.88 | ppl   131.798
| epoch   1 step     7800 |   7800 batches | lr 9.75e-05 | ms/batch 1426.90 | loss  4.67 | ppl   107.116
| epoch   1 step     8000 |   8000 batches | lr 0.0001 | ms/batch 1423.19 | loss  4.94 | ppl   139.147
----------------------------------------------------------------------------------------------------
| Eval   2 at step     8000 | time: 5951.45s | valid loss  5.38 | valid ppl   216.161
----------------------------------------------------------------------------------------------------
| epoch   1 step     8200 |   8200 batches | lr 0.000102 | ms/batch 2736.06 | loss  4.60 | ppl    99.573
| epoch   1 step     8400 |   8400 batches | lr 0.000105 | ms/batch 1423.41 | loss  4.78 | ppl   118.820
| epoch   1 step     8600 |   8600 batches | lr 0.000107 | ms/batch 1424.81 | loss  4.59 | ppl    98.743
| epoch   1 step     8800 |   8800 batches | lr 0.00011 | ms/batch 1422.94 | loss  4.63 | ppl   102.857
| epoch   1 step     9000 |   9000 batches | lr 0.000112 | ms/batch 1424.42 | loss  4.64 | ppl   103.420
| epoch   1 step     9200 |   9200 batches | lr 0.000115 | ms/batch 1422.41 | loss  4.62 | ppl   101.420
| epoch   1 step     9400 |   9400 batches | lr 0.000118 | ms/batch 1424.10 | loss  4.62 | ppl   101.589
| epoch   1 step     9600 |   9600 batches | lr 0.00012 | ms/batch 1422.79 | loss  4.48 | ppl    88.597
| epoch   1 step     9800 |   9800 batches | lr 0.000122 | ms/batch 1423.68 | loss  4.71 | ppl   111.178
| epoch   1 step    10000 |  10000 batches | lr 0.000125 | ms/batch 1421.58 | loss  4.56 | ppl    95.917
| epoch   1 step    10200 |  10200 batches | lr 0.000128 | ms/batch 1421.57 | loss  4.76 | ppl   116.692
| epoch   1 step    10400 |  10400 batches | lr 0.00013 | ms/batch 1422.06 | loss  4.56 | ppl    95.324
| epoch   1 step    10600 |  10600 batches | lr 0.000132 | ms/batch 1417.51 | loss  4.44 | ppl    85.173
| epoch   1 step    10800 |  10800 batches | lr 0.000135 | ms/batch 1419.49 | loss  4.71 | ppl   111.453
| epoch   1 step    11000 |  11000 batches | lr 0.000138 | ms/batch 1415.92 | loss  4.39 | ppl    80.764
| epoch   1 step    11200 |  11200 batches | lr 0.00014 | ms/batch 1417.95 | loss  4.70 | ppl   110.353
| epoch   1 step    11400 |  11400 batches | lr 0.000142 | ms/batch 1417.09 | loss  4.37 | ppl    78.852
| epoch   1 step    11600 |  11600 batches | lr 0.000145 | ms/batch 1419.11 | loss  4.61 | ppl    99.984
| epoch   1 step    11800 |  11800 batches | lr 0.000148 | ms/batch 1418.67 | loss  4.44 | ppl    84.494
| epoch   1 step    12000 |  12000 batches | lr 0.00015 | ms/batch 1416.78 | loss  4.48 | ppl    88.289
----------------------------------------------------------------------------------------------------
| Eval   3 at step    12000 | time: 5938.53s | valid loss  5.06 | valid ppl   156.941
----------------------------------------------------------------------------------------------------
| epoch   1 step    12200 |  12200 batches | lr 0.000153 | ms/batch 2726.48 | loss  4.69 | ppl   109.273
| epoch   1 step    12400 |  12400 batches | lr 0.000155 | ms/batch 1418.07 | loss  4.39 | ppl    80.736
| epoch   1 step    12600 |  12600 batches | lr 0.000158 | ms/batch 1416.93 | loss  4.54 | ppl    93.595
| epoch   1 step    12800 |  12800 batches | lr 0.00016 | ms/batch 1415.91 | loss  4.27 | ppl    71.206
| epoch   1 step    13000 |  13000 batches | lr 0.000162 | ms/batch 1416.22 | loss  4.37 | ppl    78.715
| epoch   1 step    13200 |  13200 batches | lr 0.000165 | ms/batch 1417.07 | loss  4.57 | ppl    96.449
| epoch   1 step    13400 |  13400 batches | lr 0.000168 | ms/batch 1414.93 | loss  4.41 | ppl    82.571
| epoch   1 step    13600 |  13600 batches | lr 0.00017 | ms/batch 1417.53 | loss  4.61 | ppl   100.385
| epoch   1 step    13800 |  13800 batches | lr 0.000173 | ms/batch 1415.54 | loss  4.06 | ppl    58.128
| epoch   1 step    14000 |  14000 batches | lr 0.000175 | ms/batch 1418.35 | loss  4.59 | ppl    98.599
| epoch   1 step    14200 |  14200 batches | lr 0.000178 | ms/batch 1415.55 | loss  4.03 | ppl    56.196
| epoch   1 step    14400 |  14400 batches | lr 0.00018 | ms/batch 1416.59 | loss  4.47 | ppl    87.262
| epoch   1 step    14600 |  14600 batches | lr 0.000182 | ms/batch 1415.62 | loss  4.15 | ppl    63.529
| epoch   1 step    14800 |  14800 batches | lr 0.000185 | ms/batch 1414.25 | loss  4.12 | ppl    61.712
| epoch   1 step    15000 |  15000 batches | lr 0.000188 | ms/batch 1414.10 | loss  4.29 | ppl    73.067
| epoch   1 step    15200 |  15200 batches | lr 0.00019 | ms/batch 1413.14 | loss  3.92 | ppl    50.347
| epoch   1 step    15400 |  15400 batches | lr 0.000193 | ms/batch 1415.58 | loss  4.45 | ppl    85.366
| epoch   1 step    15600 |  15600 batches | lr 0.000195 | ms/batch 1413.48 | loss  3.91 | ppl    49.891
| epoch   1 step    15800 |  15800 batches | lr 0.000198 | ms/batch 1415.92 | loss  4.43 | ppl    83.879
| epoch   1 step    16000 |  16000 batches | lr 0.0002 | ms/batch 1414.70 | loss  4.41 | ppl    82.209
----------------------------------------------------------------------------------------------------
| Eval   4 at step    16000 | time: 5916.94s | valid loss  4.92 | valid ppl   136.546
----------------------------------------------------------------------------------------------------
| epoch   1 step    16200 |  16200 batches | lr 0.000202 | ms/batch 2716.67 | loss  3.47 | ppl    32.128
| epoch   1 step    16400 |  16400 batches | lr 0.000205 | ms/batch 1414.36 | loss  4.14 | ppl    62.884
| epoch   1 step    16600 |  16600 batches | lr 0.000208 | ms/batch 1414.76 | loss  4.55 | ppl    94.561
| epoch   1 step    16800 |  16800 batches | lr 0.00021 | ms/batch 1414.46 | loss  4.48 | ppl    88.246
| epoch   1 step    17000 |  17000 batches | lr 0.000212 | ms/batch 1415.17 | loss  4.51 | ppl    90.691
| epoch   1 step    17200 |  17200 batches | lr 0.000215 | ms/batch 1417.76 | loss  4.59 | ppl    98.191
| epoch   1 step    17400 |  17400 batches | lr 0.000218 | ms/batch 1415.63 | loss  4.60 | ppl    99.181
| epoch   1 step    17600 |  17600 batches | lr 0.00022 | ms/batch 1416.75 | loss  4.67 | ppl   106.966
| epoch   1 step    17800 |  17800 batches | lr 0.000223 | ms/batch 1416.24 | loss  4.63 | ppl   102.495
| epoch   1 step    18000 |  18000 batches | lr 0.000225 | ms/batch 1415.40 | loss  4.62 | ppl   101.342
| epoch   1 step    18200 |  18200 batches | lr 0.000228 | ms/batch 1416.13 | loss  4.58 | ppl    97.545
| epoch   1 step    18400 |  18400 batches | lr 0.00023 | ms/batch 1414.36 | loss  4.55 | ppl    94.684
| epoch   1 step    18600 |  18600 batches | lr 0.000233 | ms/batch 1413.41 | loss  4.56 | ppl    95.377
| epoch   1 step    18800 |  18800 batches | lr 0.000235 | ms/batch 1412.81 | loss  4.55 | ppl    94.659
| epoch   1 step    19000 |  19000 batches | lr 0.000237 | ms/batch 1408.01 | loss  4.54 | ppl    93.709
| epoch   1 step    19200 |  19200 batches | lr 0.00024 | ms/batch 1408.00 | loss  4.59 | ppl    98.021
| epoch   1 step    19400 |  19400 batches | lr 0.000243 | ms/batch 1407.48 | loss  4.54 | ppl    93.368
| epoch   1 step    19600 |  19600 batches | lr 0.000245 | ms/batch 1407.41 | loss  4.54 | ppl    93.558
| epoch   1 step    19800 |  19800 batches | lr 0.000247 | ms/batch 1407.92 | loss  4.65 | ppl   104.817
| epoch   1 step    20000 |  20000 batches | lr 0.000249 | ms/batch 1408.08 | loss  4.55 | ppl    94.326
----------------------------------------------------------------------------------------------------
| Eval   5 at step    20000 | time: 5895.14s | valid loss  4.87 | valid ppl   129.794
----------------------------------------------------------------------------------------------------
| epoch   1 step    20200 |  20200 batches | lr 0.000249 | ms/batch 2669.20 | loss  4.57 | ppl    96.153
| epoch   1 step    20400 |  20400 batches | lr 0.000249 | ms/batch 1407.86 | loss  4.52 | ppl    92.152
| epoch   1 step    20600 |  20600 batches | lr 0.000249 | ms/batch 1407.16 | loss  4.48 | ppl    88.146
| epoch   1 step    20800 |  20800 batches | lr 0.000249 | ms/batch 1406.19 | loss  4.40 | ppl    81.463
| epoch   1 step    21000 |  21000 batches | lr 0.000249 | ms/batch 1407.31 | loss  4.56 | ppl    95.248
| epoch   1 step    21200 |  21200 batches | lr 0.000249 | ms/batch 1407.41 | loss  4.60 | ppl    99.341
| epoch   1 step    21400 |  21400 batches | lr 0.000249 | ms/batch 1407.14 | loss  4.59 | ppl    98.668
| epoch   1 step    21600 |  21600 batches | lr 0.000249 | ms/batch 1407.39 | loss  4.54 | ppl    93.441
| epoch   1 step    21800 |  21800 batches | lr 0.000249 | ms/batch 1407.89 | loss  4.51 | ppl    90.603
| epoch   1 step    22000 |  22000 batches | lr 0.000249 | ms/batch 1407.64 | loss  4.49 | ppl    88.976
| epoch   1 step    22200 |  22200 batches | lr 0.000249 | ms/batch 1406.61 | loss  4.49 | ppl    89.460
| epoch   1 step    22400 |  22400 batches | lr 0.000249 | ms/batch 1406.98 | loss  4.47 | ppl    87.612
| epoch   1 step    22600 |  22600 batches | lr 0.000249 | ms/batch 1406.84 | loss  4.46 | ppl    86.804
| epoch   1 step    22800 |  22800 batches | lr 0.000249 | ms/batch 1407.17 | loss  4.30 | ppl    73.355
| epoch   1 step    23000 |  23000 batches | lr 0.000249 | ms/batch 1406.98 | loss  4.24 | ppl    69.208
| epoch   1 step    23200 |  23200 batches | lr 0.000249 | ms/batch 1407.34 | loss  4.44 | ppl    84.984
| epoch   1 step    23400 |  23400 batches | lr 0.000249 | ms/batch 1407.20 | loss  4.42 | ppl    83.386
| epoch   1 step    23600 |  23600 batches | lr 0.000249 | ms/batch 1406.89 | loss  4.46 | ppl    86.251
| epoch   1 step    23800 |  23800 batches | lr 0.000249 | ms/batch 1406.65 | loss  4.39 | ppl    80.907
| epoch   1 step    24000 |  24000 batches | lr 0.000249 | ms/batch 1406.89 | loss  4.35 | ppl    77.113
----------------------------------------------------------------------------------------------------
| Eval   6 at step    24000 | time: 5873.40s | valid loss  4.76 | valid ppl   116.556
----------------------------------------------------------------------------------------------------
| epoch   1 step    24200 |  24200 batches | lr 0.000249 | ms/batch 2653.25 | loss  4.16 | ppl    64.332
| epoch   1 step    24400 |  24400 batches | lr 0.000249 | ms/batch 1406.52 | loss  4.37 | ppl    79.099
| epoch   1 step    24600 |  24600 batches | lr 0.000249 | ms/batch 1406.58 | loss  4.38 | ppl    80.053
| epoch   1 step    24800 |  24800 batches | lr 0.000248 | ms/batch 1405.99 | loss  4.38 | ppl    79.480
| epoch   1 step    25000 |  25000 batches | lr 0.000248 | ms/batch 1406.69 | loss  4.38 | ppl    79.940
| epoch   1 step    25200 |  25200 batches | lr 0.000248 | ms/batch 1406.16 | loss  4.39 | ppl    80.580
| epoch   1 step    25400 |  25400 batches | lr 0.000248 | ms/batch 1406.11 | loss  4.34 | ppl    76.763
| epoch   1 step    25600 |  25600 batches | lr 0.000248 | ms/batch 1406.11 | loss  4.37 | ppl    79.228
| epoch   1 step    25800 |  25800 batches | lr 0.000248 | ms/batch 1406.79 | loss  4.34 | ppl    76.694
| epoch   1 step    26000 |  26000 batches | lr 0.000248 | ms/batch 1406.95 | loss  4.39 | ppl    80.343
| epoch   1 step    26200 |  26200 batches | lr 0.000248 | ms/batch 1406.75 | loss  4.43 | ppl    83.889
| epoch   1 step    26400 |  26400 batches | lr 0.000248 | ms/batch 1406.16 | loss  4.43 | ppl    83.859
| epoch   1 step    26600 |  26600 batches | lr 0.000248 | ms/batch 1406.27 | loss  4.41 | ppl    82.076
| epoch   1 step    26800 |  26800 batches | lr 0.000248 | ms/batch 1406.56 | loss  4.40 | ppl    81.082
| epoch   1 step    27000 |  27000 batches | lr 0.000248 | ms/batch 1405.50 | loss  4.39 | ppl    80.493
| epoch   1 step    27200 |  27200 batches | lr 0.000248 | ms/batch 1406.54 | loss  4.37 | ppl    78.984
| epoch   1 step    27400 |  27400 batches | lr 0.000248 | ms/batch 1406.60 | loss  4.24 | ppl    69.164
| epoch   1 step    27600 |  27600 batches | lr 0.000248 | ms/batch 1412.63 | loss  4.64 | ppl   103.216
| epoch   1 step    27800 |  27800 batches | lr 0.000248 | ms/batch 1404.01 | loss  4.73 | ppl   113.385
| epoch   1 step    28000 |  28000 batches | lr 0.000248 | ms/batch 1396.67 | loss  4.64 | ppl   104.011
----------------------------------------------------------------------------------------------------
| Eval   7 at step    28000 | time: 5869.19s | valid loss  5.17 | valid ppl   175.856
----------------------------------------------------------------------------------------------------
| epoch   1 step    28200 |  28200 batches | lr 0.000248 | ms/batch 2629.07 | loss  4.65 | ppl   104.431
| epoch   1 step    28400 |  28400 batches | lr 0.000248 | ms/batch 1405.30 | loss  4.53 | ppl    92.511
| epoch   1 step    28600 |  28600 batches | lr 0.000248 | ms/batch 1405.86 | loss  4.46 | ppl    86.128
| epoch   1 step    28800 |  28800 batches | lr 0.000248 | ms/batch 1405.07 | loss  4.41 | ppl    82.499
| epoch   1 step    29000 |  29000 batches | lr 0.000248 | ms/batch 1404.92 | loss  4.41 | ppl    81.929
| epoch   1 step    29200 |  29200 batches | lr 0.000248 | ms/batch 1404.70 | loss  4.39 | ppl    80.396
| epoch   1 step    29400 |  29400 batches | lr 0.000248 | ms/batch 1405.03 | loss  4.41 | ppl    82.184
| epoch   1 step    29600 |  29600 batches | lr 0.000248 | ms/batch 1405.56 | loss  4.41 | ppl    82.176
| epoch   1 step    29800 |  29800 batches | lr 0.000248 | ms/batch 1405.44 | loss  4.40 | ppl    81.474
| epoch   1 step    30000 |  30000 batches | lr 0.000248 | ms/batch 1406.27 | loss  4.39 | ppl    80.470
| epoch   1 step    30200 |  30200 batches | lr 0.000248 | ms/batch 1405.61 | loss  4.38 | ppl    79.597
| epoch   1 step    30400 |  30400 batches | lr 0.000248 | ms/batch 1405.04 | loss  4.33 | ppl    75.779
| epoch   1 step    30600 |  30600 batches | lr 0.000248 | ms/batch 1404.95 | loss  4.37 | ppl    79.015
| epoch   1 step    30800 |  30800 batches | lr 0.000248 | ms/batch 1405.29 | loss  4.36 | ppl    78.252
| epoch   1 step    31000 |  31000 batches | lr 0.000248 | ms/batch 1405.11 | loss  4.35 | ppl    77.753
| epoch   1 step    31200 |  31200 batches | lr 0.000248 | ms/batch 1405.84 | loss  4.34 | ppl    76.556
| epoch   1 step    31400 |  31400 batches | lr 0.000248 | ms/batch 1405.11 | loss  4.33 | ppl    75.631
| epoch   1 step    31600 |  31600 batches | lr 0.000248 | ms/batch 1404.62 | loss  4.29 | ppl    72.661
| epoch   1 step    31800 |  31800 batches | lr 0.000248 | ms/batch 1405.01 | loss  4.32 | ppl    75.495
| epoch   1 step    32000 |  32000 batches | lr 0.000247 | ms/batch 1404.78 | loss  4.33 | ppl    75.800
----------------------------------------------------------------------------------------------------
| Eval   8 at step    32000 | time: 5865.69s | valid loss  4.57 | valid ppl    96.848
----------------------------------------------------------------------------------------------------
| epoch   1 step    32200 |  32200 batches | lr 0.000247 | ms/batch 2652.48 | loss  4.31 | ppl    74.727
| epoch   1 step    32400 |  32400 batches | lr 0.000247 | ms/batch 1405.37 | loss  4.30 | ppl    73.867
| epoch   1 step    32600 |  32600 batches | lr 0.000247 | ms/batch 1404.92 | loss  4.29 | ppl    73.246
| epoch   1 step    32800 |  32800 batches | lr 0.000247 | ms/batch 1404.60 | loss  4.26 | ppl    71.091
| epoch   1 step    33000 |  33000 batches | lr 0.000247 | ms/batch 1402.95 | loss  4.40 | ppl    81.259
| epoch   1 step    33200 |  33200 batches | lr 0.000247 | ms/batch 1401.55 | loss  4.31 | ppl    74.527
| epoch   1 step    33400 |  33400 batches | lr 0.000247 | ms/batch 1406.94 | loss  4.44 | ppl    84.813
| epoch   1 step    33600 |  33600 batches | lr 0.000247 | ms/batch 1403.56 | loss  4.45 | ppl    85.914
| epoch   1 step    33800 |  33800 batches | lr 0.000247 | ms/batch 1403.95 | loss  4.54 | ppl    93.537
| epoch   1 step    34000 |  34000 batches | lr 0.000247 | ms/batch 1402.81 | loss  4.66 | ppl   105.165
| epoch   1 step    34200 |  34200 batches | lr 0.000247 | ms/batch 1410.32 | loss  4.71 | ppl   110.729
| epoch   1 step    34400 |  34400 batches | lr 0.000247 | ms/batch 1406.78 | loss  4.59 | ppl    98.934
| epoch   2 step    34600 |     50 batches | lr 0.000247 | ms/batch 1407.66 | loss  4.61 | ppl   100.178
| epoch   2 step    34800 |    250 batches | lr 0.000247 | ms/batch 1406.71 | loss  4.44 | ppl    84.448
| epoch   2 step    35000 |    450 batches | lr 0.000247 | ms/batch 1407.50 | loss  4.41 | ppl    82.215
| epoch   2 step    35200 |    650 batches | lr 0.000247 | ms/batch 1408.04 | loss  4.36 | ppl    78.424
| epoch   2 step    35400 |    850 batches | lr 0.000247 | ms/batch 1407.94 | loss  4.34 | ppl    76.543
| epoch   2 step    35600 |   1050 batches | lr 0.000247 | ms/batch 1408.08 | loss  4.35 | ppl    77.411
| epoch   2 step    35800 |   1250 batches | lr 0.000247 | ms/batch 1408.28 | loss  4.33 | ppl    76.028
| epoch   2 step    36000 |   1450 batches | lr 0.000247 | ms/batch 1408.83 | loss  4.36 | ppl    78.310
----------------------------------------------------------------------------------------------------
| Eval   9 at step    36000 | time: 5869.03s | valid loss  4.56 | valid ppl    95.890
----------------------------------------------------------------------------------------------------
| epoch   2 step    36200 |   1650 batches | lr 0.000247 | ms/batch 2654.61 | loss  4.34 | ppl    76.827
| epoch   2 step    36400 |   1850 batches | lr 0.000247 | ms/batch 1407.64 | loss  4.37 | ppl    78.883
| epoch   2 step    36600 |   2050 batches | lr 0.000247 | ms/batch 1408.10 | loss  4.34 | ppl    76.577
| epoch   2 step    36800 |   2250 batches | lr 0.000247 | ms/batch 1407.22 | loss  4.33 | ppl    75.863
| epoch   2 step    37000 |   2450 batches | lr 0.000247 | ms/batch 1407.53 | loss  4.34 | ppl    76.505
| epoch   2 step    37200 |   2650 batches | lr 0.000247 | ms/batch 1408.53 | loss  4.34 | ppl    76.456
| epoch   2 step    37400 |   2850 batches | lr 0.000247 | ms/batch 1407.92 | loss  4.32 | ppl    75.349
| epoch   2 step    37600 |   3050 batches | lr 0.000247 | ms/batch 1408.48 | loss  4.32 | ppl    75.392
| epoch   2 step    37800 |   3250 batches | lr 0.000246 | ms/batch 1407.67 | loss  4.34 | ppl    76.973
| epoch   2 step    38000 |   3450 batches | lr 0.000246 | ms/batch 1407.59 | loss  4.36 | ppl    78.519
| epoch   2 step    38200 |   3650 batches | lr 0.000246 | ms/batch 1406.93 | loss  4.40 | ppl    81.047
| epoch   2 step    38400 |   3850 batches | lr 0.000246 | ms/batch 1407.01 | loss  4.38 | ppl    79.879
| epoch   2 step    38600 |   4050 batches | lr 0.000246 | ms/batch 1406.50 | loss  4.39 | ppl    80.880
| epoch   2 step    38800 |   4250 batches | lr 0.000246 | ms/batch 1406.39 | loss  4.43 | ppl    84.094
| epoch   2 step    39000 |   4450 batches | lr 0.000246 | ms/batch 1406.55 | loss  4.36 | ppl    78.487
| epoch   2 step    39200 |   4650 batches | lr 0.000246 | ms/batch 1405.97 | loss  4.29 | ppl    73.255
| epoch   2 step    39400 |   4850 batches | lr 0.000246 | ms/batch 1405.52 | loss  4.29 | ppl    72.792
| epoch   2 step    39600 |   5050 batches | lr 0.000246 | ms/batch 1406.70 | loss  4.33 | ppl    75.729
| epoch   2 step    39800 |   5250 batches | lr 0.000246 | ms/batch 1406.09 | loss  4.30 | ppl    73.585
| epoch   2 step    40000 |   5450 batches | lr 0.000246 | ms/batch 1405.41 | loss  4.32 | ppl    75.299
----------------------------------------------------------------------------------------------------
| Eval  10 at step    40000 | time: 5872.98s | valid loss  4.59 | valid ppl    98.386
----------------------------------------------------------------------------------------------------
| epoch   2 step    40200 |   5650 batches | lr 0.000246 | ms/batch 2628.21 | loss  4.33 | ppl    76.267
| epoch   2 step    40400 |   5850 batches | lr 0.000246 | ms/batch 1406.23 | loss  4.28 | ppl    72.296
| epoch   2 step    40600 |   6050 batches | lr 0.000246 | ms/batch 1407.25 | loss  4.19 | ppl    65.723
| epoch   2 step    40800 |   6250 batches | lr 0.000246 | ms/batch 1408.92 | loss  4.33 | ppl    76.236
| epoch   2 step    41000 |   6450 batches | lr 0.000246 | ms/batch 1409.23 | loss  4.34 | ppl    76.811
| epoch   2 step    41200 |   6650 batches | lr 0.000246 | ms/batch 1409.55 | loss  4.11 | ppl    60.842
| epoch   2 step    41400 |   6850 batches | lr 0.000246 | ms/batch 1410.26 | loss  4.31 | ppl    74.388
| epoch   2 step    41600 |   7050 batches | lr 0.000246 | ms/batch 1408.81 | loss  4.01 | ppl    55.278
| epoch   2 step    41800 |   7250 batches | lr 0.000246 | ms/batch 1407.73 | loss  4.30 | ppl    73.393
| epoch   2 step    42000 |   7450 batches | lr 0.000246 | ms/batch 1409.85 | loss  4.03 | ppl    56.337
| epoch   2 step    42200 |   7650 batches | lr 0.000246 | ms/batch 1409.02 | loss  4.29 | ppl    73.097
| epoch   2 step    42400 |   7850 batches | lr 0.000246 | ms/batch 1410.89 | loss  4.08 | ppl    59.069
| epoch   2 step    42600 |   8050 batches | lr 0.000246 | ms/batch 1409.15 | loss  4.20 | ppl    67.020
| epoch   2 step    42800 |   8250 batches | lr 0.000246 | ms/batch 1410.27 | loss  4.08 | ppl    59.117
| epoch   2 step    43000 |   8450 batches | lr 0.000245 | ms/batch 1408.50 | loss  4.20 | ppl    66.777
| epoch   2 step    43200 |   8650 batches | lr 0.000245 | ms/batch 1409.88 | loss  4.17 | ppl    64.791
| epoch   2 step    43400 |   8850 batches | lr 0.000245 | ms/batch 1410.20 | loss  4.05 | ppl    57.445
| epoch   2 step    43600 |   9050 batches | lr 0.000245 | ms/batch 1409.16 | loss  4.31 | ppl    74.770
| epoch   2 step    43800 |   9250 batches | lr 0.000245 | ms/batch 1410.74 | loss  4.66 | ppl   105.395
| epoch   2 step    44000 |   9450 batches | lr 0.000245 | ms/batch 1407.11 | loss  5.18 | ppl   177.010
----------------------------------------------------------------------------------------------------
| Eval  11 at step    44000 | time: 5880.10s | valid loss  4.88 | valid ppl   132.180
----------------------------------------------------------------------------------------------------
| epoch   2 step    44200 |   9650 batches | lr 0.000245 | ms/batch 2631.51 | loss  4.78 | ppl   118.807
| epoch   2 step    44400 |   9850 batches | lr 0.000245 | ms/batch 1406.91 | loss  4.93 | ppl   138.873
| epoch   2 step    44600 |  10050 batches | lr 0.000245 | ms/batch 1407.45 | loss  4.59 | ppl    98.305
| epoch   2 step    44800 |  10250 batches | lr 0.000245 | ms/batch 1407.36 | loss  4.46 | ppl    86.878
| epoch   2 step    45000 |  10450 batches | lr 0.000245 | ms/batch 1406.50 | loss  4.31 | ppl    74.472
| epoch   2 step    45200 |  10650 batches | lr 0.000245 | ms/batch 1402.13 | loss  4.25 | ppl    70.305
| epoch   2 step    45400 |  10850 batches | lr 0.000245 | ms/batch 1404.65 | loss  4.37 | ppl    79.315
| epoch   2 step    45600 |  11050 batches | lr 0.000245 | ms/batch 1403.17 | loss  4.20 | ppl    66.790
| epoch   2 step    45800 |  11250 batches | lr 0.000245 | ms/batch 1404.41 | loss  4.32 | ppl    75.532
| epoch   2 step    46000 |  11450 batches | lr 0.000245 | ms/batch 1403.38 | loss  5.47 | ppl   236.869
| epoch   2 step    46200 |  11650 batches | lr 0.000245 | ms/batch 1402.95 | loss  6.61 | ppl   745.187
| epoch   2 step    46400 |  11850 batches | lr 0.000245 | ms/batch 1404.47 | loss  5.21 | ppl   182.647
| epoch   2 step    46600 |  12050 batches | lr 0.000245 | ms/batch 1403.67 | loss  4.34 | ppl    76.910
| epoch   2 step    46800 |  12250 batches | lr 0.000245 | ms/batch 1403.82 | loss  4.50 | ppl    90.158
| epoch   2 step    47000 |  12450 batches | lr 0.000245 | ms/batch 1404.93 | loss  4.23 | ppl    68.527
| epoch   2 step    47200 |  12650 batches | lr 0.000245 | ms/batch 1401.66 | loss  4.28 | ppl    72.558
| epoch   2 step    47400 |  12850 batches | lr 0.000244 | ms/batch 1403.94 | loss  4.48 | ppl    88.329
| epoch   2 step    47600 |  13050 batches | lr 0.000244 | ms/batch 1402.97 | loss  4.28 | ppl    72.105
| epoch   2 step    47800 |  13250 batches | lr 0.000244 | ms/batch 1403.74 | loss  4.51 | ppl    90.804
| epoch   2 step    48000 |  13450 batches | lr 0.000244 | ms/batch 1403.13 | loss  4.24 | ppl    69.714
----------------------------------------------------------------------------------------------------
| Eval  12 at step    48000 | time: 5862.63s | valid loss  4.85 | valid ppl   127.735
----------------------------------------------------------------------------------------------------
| epoch   2 step    48200 |  13650 batches | lr 0.000244 | ms/batch 2625.77 | loss  4.44 | ppl    85.025
| epoch   2 step    48400 |  13850 batches | lr 0.000244 | ms/batch 1403.38 | loss  4.29 | ppl    72.698
| epoch   2 step    48600 |  14050 batches | lr 0.000244 | ms/batch 1402.91 | loss  4.45 | ppl    85.520
| epoch   2 step    48800 |  14250 batches | lr 0.000244 | ms/batch 1401.49 | loss  4.32 | ppl    75.127
| epoch   2 step    49000 |  14450 batches | lr 0.000244 | ms/batch 1401.77 | loss  5.23 | ppl   187.258
| epoch   2 step    49200 |  14650 batches | lr 0.000244 | ms/batch 1402.02 | loss  4.40 | ppl    81.559
| epoch   2 step    49400 |  14850 batches | lr 0.000244 | ms/batch 1387.90 | loss  6.74 | ppl   849.556
| epoch   2 step    49600 |  15050 batches | lr 0.000244 | ms/batch 1383.99 | loss  8.30 | ppl  4030.151
| epoch   2 step    49800 |  15250 batches | lr 0.000244 | ms/batch 1379.58 | loss  8.07 | ppl  3181.266
| epoch   2 step    50000 |  15450 batches | lr 0.000244 | ms/batch 1383.43 | loss  8.29 | ppl  3989.660
| epoch   2 step    50200 |  15650 batches | lr 0.000244 | ms/batch 1380.73 | loss  8.07 | ppl  3198.021
| epoch   2 step    50400 |  15850 batches | lr 0.000244 | ms/batch 1382.30 | loss  8.32 | ppl  4086.152
| epoch   2 step    50600 |  16050 batches | lr 0.000244 | ms/batch 1381.75 | loss  8.18 | ppl  3574.763
| epoch   2 step    50800 |  16250 batches | lr 0.000244 | ms/batch 1380.56 | loss  8.00 | ppl  2987.531
| epoch   2 step    51000 |  16450 batches | lr 0.000244 | ms/batch 1382.08 | loss  8.29 | ppl  3994.928
| epoch   2 step    51200 |  16650 batches | lr 0.000244 | ms/batch 1381.72 | loss  8.28 | ppl  3932.796
| epoch   2 step    51400 |  16850 batches | lr 0.000244 | ms/batch 1381.64 | loss  8.30 | ppl  4038.151
| epoch   2 step    51600 |  17050 batches | lr 0.000243 | ms/batch 1384.39 | loss  8.24 | ppl  3793.722
| epoch   2 step    51800 |  17250 batches | lr 0.000243 | ms/batch 1385.39 | loss  8.19 | ppl  3599.912
| epoch   2 step    52000 |  17450 batches | lr 0.000243 | ms/batch 1383.34 | loss  8.24 | ppl  3776.562
----------------------------------------------------------------------------------------------------
| Eval  13 at step    52000 | time: 5798.19s | valid loss  8.35 | valid ppl  4216.352
----------------------------------------------------------------------------------------------------
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
slurmstepd: error: *** STEP 51668743.0 ON dgx03 CANCELLED AT 2020-04-09T14:33:28 ***
slurmstepd: error: *** JOB 51668743 ON dgx03 CANCELLED AT 2020-04-09T14:33:28 ***
/usr/bin/epilog: line 3: grep: command not found
