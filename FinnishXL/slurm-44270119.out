Run training...
Experiment dir : /m/triton/scratch/elec/puhe/p/jaina5/transformer-xl/FinnishXL/-Ktrain/20190818-124135
Producing dataset Ktrain...
building vocab from /m/triton/scratch/elec/puhe/p/jaina5/transformer-xl/FinnishXL/data/cp_kiel_train/vocab_train.txt
final vocab size 34519
/m/triton/scratch/elec/puhe/p/jaina5/transformer-xl/FinnishXL/data/cp_kiel_train/train.txt
/m/triton/scratch/elec/puhe/p/jaina5/transformer-xl/FinnishXL/data/cp_kiel_train/valid.txt
/m/triton/scratch/elec/puhe/p/jaina5/transformer-xl/FinnishXL/data/cp_kiel_train/test.txt
====================================================================================================
    - data : /m/triton/scratch/elec/puhe/p/jaina5/transformer-xl/FinnishXL/data/cp_kiel_train/
    - dataset : Ktrain
    - n_layer : 4
    - n_head : 8
    - d_head : 128
    - d_embed : 1024
    - d_model : 1024
    - d_inner : 4096
    - dropout : 0.0
    - dropatt : 0.0
    - init : normal
    - emb_init : normal
    - init_range : 0.1
    - emb_init_range : 0.01
    - init_std : 0.02
    - proj_init_std : 0.01
    - optim : adam
    - lr : 0.00025
    - mom : 0.0
    - scheduler : cosine
    - warmup_step : 40000
    - decay_rate : 0.5
    - lr_min : 0.0
    - clip : 0.25
    - clip_nonemb : False
    - max_step : 500000
    - batch_size : 224
    - batch_chunk : 1
    - tgt_len : 32
    - eval_tgt_len : 32
    - ext_len : 0
    - mem_len : 32
    - not_tied : False
    - seed : 1111
    - cuda : True
    - adaptive : False
    - div_val : 1
    - pre_lnorm : False
    - varlen : False
    - multi_gpu : False
    - log_interval : 200
    - eval_interval : 4000
    - work_dir : /m/triton/scratch/elec/puhe/p/jaina5/transformer-xl/FinnishXL/-Ktrain/20190818-124135
    - restart : True
    - restart_dir : /m/triton/scratch/elec/puhe/p/jaina5/transformer-xl/FinnishXL/-Ktrain/20190815-205709-test/
    - debug : False
    - same_length : False
    - attn_type : 0
    - clamp_len : -1
    - eta_min : 0.0
    - gpu0_bsz : -1
    - max_eval_steps : -1
    - sample_softmax : -1
    - patience : 0
    - finetune_v2 : False
    - finetune_v3 : False
    - fp16 : False
    - static_loss_scale : 1
    - dynamic_loss_scale : False
    - tied : True
    - n_token : 34519
    - n_all_param : 89946839
    - n_nonemb_param : 54562816
====================================================================================================
#params = 89946839
#non emb params = 54562816
| epoch   1 step      200 |    200 batches | lr 1.25e-06 | ms/batch 444.19 | loss  4.31 | ppl    74.471
| epoch   1 step      400 |    400 batches | lr 2.5e-06 | ms/batch 450.64 | loss  4.28 | ppl    72.448
| epoch   1 step      600 |    600 batches | lr 3.75e-06 | ms/batch 450.94 | loss  4.26 | ppl    71.043
| epoch   1 step      800 |    800 batches | lr 5e-06 | ms/batch 450.14 | loss  4.25 | ppl    70.352
| epoch   1 step     1000 |   1000 batches | lr 6.25e-06 | ms/batch 450.54 | loss  4.23 | ppl    68.912
| epoch   1 step     1200 |   1200 batches | lr 7.5e-06 | ms/batch 450.76 | loss  4.22 | ppl    68.098
| epoch   1 step     1400 |   1400 batches | lr 8.75e-06 | ms/batch 450.59 | loss  4.21 | ppl    67.418
| epoch   1 step     1600 |   1600 batches | lr 1e-05 | ms/batch 450.53 | loss  4.21 | ppl    67.054
| epoch   1 step     1800 |   1800 batches | lr 1.13e-05 | ms/batch 450.31 | loss  4.19 | ppl    66.185
| epoch   1 step     2000 |   2000 batches | lr 1.25e-05 | ms/batch 450.39 | loss  4.19 | ppl    65.712
| epoch   1 step     2200 |   2200 batches | lr 1.38e-05 | ms/batch 450.64 | loss  4.18 | ppl    65.540
| epoch   1 step     2400 |   2400 batches | lr 1.5e-05 | ms/batch 450.35 | loss  4.17 | ppl    64.728
| epoch   1 step     2600 |   2600 batches | lr 1.63e-05 | ms/batch 450.53 | loss  4.16 | ppl    64.140
| epoch   1 step     2800 |   2800 batches | lr 1.75e-05 | ms/batch 450.43 | loss  4.15 | ppl    63.579
| epoch   1 step     3000 |   3000 batches | lr 1.87e-05 | ms/batch 450.51 | loss  4.14 | ppl    62.786
| epoch   1 step     3200 |   3200 batches | lr 2e-05 | ms/batch 450.45 | loss  4.13 | ppl    62.279
| epoch   2 step     3400 |    109 batches | lr 2.12e-05 | ms/batch 450.38 | loss  4.11 | ppl    61.190
| epoch   2 step     3600 |    309 batches | lr 2.25e-05 | ms/batch 450.43 | loss  4.09 | ppl    59.848
| epoch   2 step     3800 |    509 batches | lr 2.38e-05 | ms/batch 450.49 | loss  4.09 | ppl    59.444
| epoch   2 step     4000 |    709 batches | lr 2.5e-05 | ms/batch 450.36 | loss  4.07 | ppl    58.848
----------------------------------------------------------------------------------------------------
| Eval   1 at step     4000 | time: 1802.64s | valid loss  4.34 | valid ppl    76.367
----------------------------------------------------------------------------------------------------
| epoch   2 step     4200 |    909 batches | lr 2.63e-05 | ms/batch 466.81 | loss  4.07 | ppl    58.607
| epoch   2 step     4400 |   1109 batches | lr 2.75e-05 | ms/batch 450.50 | loss  4.07 | ppl    58.400
| epoch   2 step     4600 |   1309 batches | lr 2.88e-05 | ms/batch 450.68 | loss  4.06 | ppl    58.073
| epoch   2 step     4800 |   1509 batches | lr 3e-05 | ms/batch 450.52 | loss  4.05 | ppl    57.416
| epoch   2 step     5000 |   1709 batches | lr 3.13e-05 | ms/batch 450.60 | loss  4.05 | ppl    57.196
| epoch   2 step     5200 |   1909 batches | lr 3.25e-05 | ms/batch 450.58 | loss  4.04 | ppl    56.704
| epoch   2 step     5400 |   2109 batches | lr 3.38e-05 | ms/batch 450.36 | loss  4.04 | ppl    56.566
| epoch   2 step     5600 |   2309 batches | lr 3.5e-05 | ms/batch 450.81 | loss  4.03 | ppl    56.242
| epoch   2 step     5800 |   2509 batches | lr 3.63e-05 | ms/batch 450.72 | loss  4.02 | ppl    55.597
| epoch   2 step     6000 |   2709 batches | lr 3.75e-05 | ms/batch 450.48 | loss  4.01 | ppl    55.159
| epoch   2 step     6200 |   2909 batches | lr 3.87e-05 | ms/batch 450.73 | loss  4.01 | ppl    54.971
| epoch   2 step     6400 |   3109 batches | lr 4e-05 | ms/batch 450.59 | loss  4.00 | ppl    54.663
| epoch   3 step     6600 |     18 batches | lr 4.13e-05 | ms/batch 450.57 | loss  3.99 | ppl    54.041
| epoch   3 step     6800 |    218 batches | lr 4.25e-05 | ms/batch 450.55 | loss  3.91 | ppl    50.108
| epoch   3 step     7000 |    418 batches | lr 4.37e-05 | ms/batch 450.34 | loss  3.91 | ppl    49.848
| epoch   3 step     7200 |    618 batches | lr 4.5e-05 | ms/batch 450.36 | loss  3.92 | ppl    50.169
| epoch   3 step     7400 |    818 batches | lr 4.62e-05 | ms/batch 450.73 | loss  3.91 | ppl    49.825
| epoch   3 step     7600 |   1018 batches | lr 4.75e-05 | ms/batch 450.91 | loss  3.91 | ppl    49.664
| epoch   3 step     7800 |   1218 batches | lr 4.87e-05 | ms/batch 450.63 | loss  3.90 | ppl    49.314
| epoch   3 step     8000 |   1418 batches | lr 5e-05 | ms/batch 450.41 | loss  3.90 | ppl    49.172
----------------------------------------------------------------------------------------------------
| Eval   2 at step     8000 | time: 1804.16s | valid loss  4.43 | valid ppl    83.927
----------------------------------------------------------------------------------------------------
| epoch   3 step     8200 |   1618 batches | lr 5.12e-05 | ms/batch 459.91 | loss  3.89 | ppl    48.807
| epoch   3 step     8400 |   1818 batches | lr 5.25e-05 | ms/batch 450.31 | loss  3.88 | ppl    48.437
| epoch   3 step     8600 |   2018 batches | lr 5.37e-05 | ms/batch 449.91 | loss  3.88 | ppl    48.211
| epoch   3 step     8800 |   2218 batches | lr 5.5e-05 | ms/batch 450.52 | loss  3.87 | ppl    48.086
| epoch   3 step     9000 |   2418 batches | lr 5.62e-05 | ms/batch 450.62 | loss  3.87 | ppl    48.008
| epoch   3 step     9200 |   2618 batches | lr 5.75e-05 | ms/batch 450.70 | loss  3.87 | ppl    47.989
| epoch   3 step     9400 |   2818 batches | lr 5.88e-05 | ms/batch 450.81 | loss  3.86 | ppl    47.422
| epoch   3 step     9600 |   3018 batches | lr 6e-05 | ms/batch 450.40 | loss  3.85 | ppl    47.100
| epoch   3 step     9800 |   3218 batches | lr 6.12e-05 | ms/batch 450.57 | loss  3.85 | ppl    46.999
| epoch   4 step    10000 |    127 batches | lr 6.25e-05 | ms/batch 450.50 | loss  3.77 | ppl    43.197
| epoch   4 step    10200 |    327 batches | lr 6.38e-05 | ms/batch 450.63 | loss  3.72 | ppl    41.382
| epoch   4 step    10400 |    527 batches | lr 6.5e-05 | ms/batch 450.37 | loss  3.73 | ppl    41.547
| epoch   4 step    10600 |    727 batches | lr 6.62e-05 | ms/batch 450.54 | loss  3.73 | ppl    41.566
| epoch   4 step    10800 |    927 batches | lr 6.75e-05 | ms/batch 450.71 | loss  3.73 | ppl    41.574
| epoch   4 step    11000 |   1127 batches | lr 6.88e-05 | ms/batch 450.37 | loss  3.73 | ppl    41.485
| epoch   4 step    11200 |   1327 batches | lr 7e-05 | ms/batch 450.44 | loss  3.72 | ppl    41.363
| epoch   4 step    11400 |   1527 batches | lr 7.12e-05 | ms/batch 450.41 | loss  3.72 | ppl    41.300
| epoch   4 step    11600 |   1727 batches | lr 7.25e-05 | ms/batch 450.29 | loss  3.72 | ppl    41.214
| epoch   4 step    11800 |   1927 batches | lr 7.38e-05 | ms/batch 450.47 | loss  3.71 | ppl    40.862
| epoch   4 step    12000 |   2127 batches | lr 7.5e-05 | ms/batch 450.36 | loss  3.71 | ppl    40.802
----------------------------------------------------------------------------------------------------
| Eval   3 at step    12000 | time: 1803.79s | valid loss  4.60 | valid ppl    99.087
----------------------------------------------------------------------------------------------------
| epoch   4 step    12200 |   2327 batches | lr 7.63e-05 | ms/batch 459.39 | loss  3.71 | ppl    40.719
| epoch   4 step    12400 |   2527 batches | lr 7.75e-05 | ms/batch 450.24 | loss  3.70 | ppl    40.359
| epoch   4 step    12600 |   2727 batches | lr 7.88e-05 | ms/batch 450.49 | loss  3.69 | ppl    40.201
| epoch   4 step    12800 |   2927 batches | lr 8e-05 | ms/batch 450.49 | loss  3.69 | ppl    40.019
| epoch   4 step    13000 |   3127 batches | lr 8.12e-05 | ms/batch 450.48 | loss  3.68 | ppl    39.582
| epoch   5 step    13200 |     36 batches | lr 8.25e-05 | ms/batch 450.26 | loss  3.66 | ppl    38.701
| epoch   5 step    13400 |    236 batches | lr 8.38e-05 | ms/batch 450.40 | loss  3.53 | ppl    34.028
| epoch   5 step    13600 |    436 batches | lr 8.5e-05 | ms/batch 450.68 | loss  3.53 | ppl    34.150
| epoch   5 step    13800 |    636 batches | lr 8.63e-05 | ms/batch 450.71 | loss  3.53 | ppl    34.201
| epoch   5 step    14000 |    836 batches | lr 8.75e-05 | ms/batch 450.79 | loss  3.54 | ppl    34.342
| epoch   5 step    14200 |   1036 batches | lr 8.88e-05 | ms/batch 450.49 | loss  3.53 | ppl    34.274
| epoch   5 step    14400 |   1236 batches | lr 9e-05 | ms/batch 450.82 | loss  3.53 | ppl    34.293
| epoch   5 step    14600 |   1436 batches | lr 9.12e-05 | ms/batch 450.48 | loss  3.54 | ppl    34.383
| epoch   5 step    14800 |   1636 batches | lr 9.25e-05 | ms/batch 450.46 | loss  3.54 | ppl    34.298
| epoch   5 step    15000 |   1836 batches | lr 9.38e-05 | ms/batch 450.46 | loss  3.52 | ppl    33.910
| epoch   5 step    15200 |   2036 batches | lr 9.5e-05 | ms/batch 450.99 | loss  3.53 | ppl    34.109
| epoch   5 step    15400 |   2236 batches | lr 9.63e-05 | ms/batch 450.42 | loss  3.53 | ppl    33.958
| epoch   5 step    15600 |   2436 batches | lr 9.75e-05 | ms/batch 450.25 | loss  3.52 | ppl    33.855
| epoch   5 step    15800 |   2636 batches | lr 9.88e-05 | ms/batch 450.23 | loss  3.52 | ppl    33.727
| epoch   5 step    16000 |   2836 batches | lr 0.0001 | ms/batch 450.11 | loss  3.51 | ppl    33.588
----------------------------------------------------------------------------------------------------
| Eval   4 at step    16000 | time: 1803.75s | valid loss  4.83 | valid ppl   125.131
----------------------------------------------------------------------------------------------------
| epoch   5 step    16200 |   3036 batches | lr 0.000101 | ms/batch 460.00 | loss  3.51 | ppl    33.539
| epoch   5 step    16400 |   3236 batches | lr 0.000102 | ms/batch 450.53 | loss  3.51 | ppl    33.484
| epoch   6 step    16600 |    145 batches | lr 0.000104 | ms/batch 450.43 | loss  3.37 | ppl    29.171
| epoch   6 step    16800 |    345 batches | lr 0.000105 | ms/batch 450.64 | loss  3.33 | ppl    27.893
| epoch   6 step    17000 |    545 batches | lr 0.000106 | ms/batch 450.77 | loss  3.33 | ppl    27.919
| epoch   6 step    17200 |    745 batches | lr 0.000107 | ms/batch 450.91 | loss  3.34 | ppl    28.229
| epoch   6 step    17400 |    945 batches | lr 0.000109 | ms/batch 450.79 | loss  3.34 | ppl    28.249
| epoch   6 step    17600 |   1145 batches | lr 0.00011 | ms/batch 450.56 | loss  3.34 | ppl    28.179
| epoch   6 step    17800 |   1345 batches | lr 0.000111 | ms/batch 450.44 | loss  3.34 | ppl    28.299
| epoch   6 step    18000 |   1545 batches | lr 0.000112 | ms/batch 450.60 | loss  3.35 | ppl    28.613
| epoch   6 step    18200 |   1745 batches | lr 0.000114 | ms/batch 450.36 | loss  3.35 | ppl    28.517
| epoch   6 step    18400 |   1945 batches | lr 0.000115 | ms/batch 450.12 | loss  3.35 | ppl    28.560
| epoch   6 step    18600 |   2145 batches | lr 0.000116 | ms/batch 449.36 | loss  3.34 | ppl    28.281
| epoch   6 step    18800 |   2345 batches | lr 0.000118 | ms/batch 450.06 | loss  3.35 | ppl    28.377
| epoch   6 step    19000 |   2545 batches | lr 0.000119 | ms/batch 450.37 | loss  3.34 | ppl    28.180
| epoch   6 step    19200 |   2745 batches | lr 0.00012 | ms/batch 450.58 | loss  3.34 | ppl    28.344
| epoch   6 step    19400 |   2945 batches | lr 0.000121 | ms/batch 450.66 | loss  3.35 | ppl    28.479
| epoch   6 step    19600 |   3145 batches | lr 0.000122 | ms/batch 450.60 | loss  3.34 | ppl    28.180
| epoch   7 step    19800 |     54 batches | lr 0.000124 | ms/batch 450.42 | loss  3.28 | ppl    26.602
| epoch   7 step    20000 |    254 batches | lr 0.000125 | ms/batch 450.76 | loss  3.12 | ppl    22.709
----------------------------------------------------------------------------------------------------
| Eval   5 at step    20000 | time: 1803.81s | valid loss  5.22 | valid ppl   185.729
----------------------------------------------------------------------------------------------------
| epoch   7 step    20200 |    454 batches | lr 0.000126 | ms/batch 459.73 | loss  3.14 | ppl    23.124
| epoch   7 step    20400 |    654 batches | lr 0.000128 | ms/batch 450.72 | loss  3.15 | ppl    23.238
| epoch   7 step    20600 |    854 batches | lr 0.000129 | ms/batch 450.71 | loss  3.16 | ppl    23.508
| epoch   7 step    20800 |   1054 batches | lr 0.00013 | ms/batch 450.94 | loss  3.16 | ppl    23.641
| epoch   7 step    21000 |   1254 batches | lr 0.000131 | ms/batch 450.73 | loss  3.17 | ppl    23.737
| epoch   7 step    21200 |   1454 batches | lr 0.000132 | ms/batch 450.80 | loss  3.17 | ppl    23.849
| epoch   7 step    21400 |   1654 batches | lr 0.000134 | ms/batch 450.68 | loss  3.17 | ppl    23.907
| epoch   7 step    21600 |   1854 batches | lr 0.000135 | ms/batch 450.60 | loss  3.18 | ppl    24.122
| epoch   7 step    21800 |   2054 batches | lr 0.000136 | ms/batch 450.63 | loss  3.18 | ppl    24.031
| epoch   7 step    22000 |   2254 batches | lr 0.000138 | ms/batch 450.77 | loss  3.18 | ppl    24.154
| epoch   7 step    22200 |   2454 batches | lr 0.000139 | ms/batch 451.01 | loss  3.19 | ppl    24.264
| epoch   7 step    22400 |   2654 batches | lr 0.00014 | ms/batch 450.65 | loss  3.19 | ppl    24.216
| epoch   7 step    22600 |   2854 batches | lr 0.000141 | ms/batch 450.58 | loss  3.19 | ppl    24.227
| epoch   7 step    22800 |   3054 batches | lr 0.000142 | ms/batch 450.49 | loss  3.19 | ppl    24.356
| epoch   7 step    23000 |   3254 batches | lr 0.000144 | ms/batch 450.71 | loss  3.18 | ppl    24.091
| epoch   8 step    23200 |    163 batches | lr 0.000145 | ms/batch 450.49 | loss  2.99 | ppl    19.923
| epoch   8 step    23400 |    363 batches | lr 0.000146 | ms/batch 450.73 | loss  2.96 | ppl    19.350
| epoch   8 step    23600 |    563 batches | lr 0.000148 | ms/batch 450.43 | loss  2.98 | ppl    19.754
| epoch   8 step    23800 |    763 batches | lr 0.000149 | ms/batch 450.81 | loss  3.00 | ppl    20.012
| epoch   8 step    24000 |    963 batches | lr 0.00015 | ms/batch 450.73 | loss  3.01 | ppl    20.308
----------------------------------------------------------------------------------------------------
| Eval   6 at step    24000 | time: 1804.61s | valid loss  5.52 | valid ppl   249.115
----------------------------------------------------------------------------------------------------
| epoch   8 step    24200 |   1163 batches | lr 0.000151 | ms/batch 460.01 | loss  3.02 | ppl    20.398
| epoch   8 step    24400 |   1363 batches | lr 0.000153 | ms/batch 450.66 | loss  3.02 | ppl    20.567
| epoch   8 step    24600 |   1563 batches | lr 0.000154 | ms/batch 450.70 | loss  3.03 | ppl    20.703
| epoch   8 step    24800 |   1763 batches | lr 0.000155 | ms/batch 450.77 | loss  3.04 | ppl    20.877
| epoch   8 step    25000 |   1963 batches | lr 0.000156 | ms/batch 450.70 | loss  3.04 | ppl    20.982
| epoch   8 step    25200 |   2163 batches | lr 0.000158 | ms/batch 450.70 | loss  3.04 | ppl    20.999
| epoch   8 step    25400 |   2363 batches | lr 0.000159 | ms/batch 450.77 | loss  3.06 | ppl    21.251
| epoch   8 step    25600 |   2563 batches | lr 0.00016 | ms/batch 450.59 | loss  3.05 | ppl    21.172
| epoch   8 step    25800 |   2763 batches | lr 0.000161 | ms/batch 450.96 | loss  3.05 | ppl    21.156
| epoch   8 step    26000 |   2963 batches | lr 0.000162 | ms/batch 450.96 | loss  3.06 | ppl    21.230
| epoch   8 step    26200 |   3163 batches | lr 0.000164 | ms/batch 450.90 | loss  3.06 | ppl    21.363
| epoch   9 step    26400 |     72 batches | lr 0.000165 | ms/batch 450.66 | loss  2.97 | ppl    19.563
| epoch   9 step    26600 |    272 batches | lr 0.000166 | ms/batch 451.07 | loss  2.82 | ppl    16.735
| epoch   9 step    26800 |    472 batches | lr 0.000168 | ms/batch 450.87 | loss  2.84 | ppl    17.111
| epoch   9 step    27000 |    672 batches | lr 0.000169 | ms/batch 450.81 | loss  2.85 | ppl    17.366
| epoch   9 step    27200 |    872 batches | lr 0.00017 | ms/batch 450.89 | loss  2.88 | ppl    17.833
| epoch   9 step    27400 |   1072 batches | lr 0.000171 | ms/batch 450.99 | loss  2.90 | ppl    18.100
| epoch   9 step    27600 |   1272 batches | lr 0.000173 | ms/batch 450.79 | loss  2.90 | ppl    18.225
| epoch   9 step    27800 |   1472 batches | lr 0.000174 | ms/batch 450.95 | loss  2.92 | ppl    18.522
| epoch   9 step    28000 |   1672 batches | lr 0.000175 | ms/batch 450.80 | loss  2.93 | ppl    18.676
----------------------------------------------------------------------------------------------------
| Eval   7 at step    28000 | time: 1805.12s | valid loss  5.77 | valid ppl   320.939
----------------------------------------------------------------------------------------------------
| epoch   9 step    28200 |   1872 batches | lr 0.000176 | ms/batch 460.21 | loss  2.93 | ppl    18.731
| epoch   9 step    28400 |   2072 batches | lr 0.000178 | ms/batch 450.18 | loss  2.93 | ppl    18.799
| epoch   9 step    28600 |   2272 batches | lr 0.000179 | ms/batch 450.39 | loss  2.95 | ppl    19.011
| epoch   9 step    28800 |   2472 batches | lr 0.00018 | ms/batch 450.82 | loss  2.95 | ppl    19.028
| epoch   9 step    29000 |   2672 batches | lr 0.000181 | ms/batch 450.85 | loss  2.95 | ppl    19.187
| epoch   9 step    29200 |   2872 batches | lr 0.000182 | ms/batch 450.94 | loss  2.96 | ppl    19.350
| epoch   9 step    29400 |   3072 batches | lr 0.000184 | ms/batch 450.92 | loss  2.97 | ppl    19.415
| epoch   9 step    29600 |   3272 batches | lr 0.000185 | ms/batch 450.86 | loss  2.97 | ppl    19.399
| epoch  10 step    29800 |    181 batches | lr 0.000186 | ms/batch 450.69 | loss  2.73 | ppl    15.353
| epoch  10 step    30000 |    381 batches | lr 0.000188 | ms/batch 450.91 | loss  2.73 | ppl    15.354
| epoch  10 step    30200 |    581 batches | lr 0.000189 | ms/batch 450.83 | loss  2.76 | ppl    15.788
| epoch  10 step    30400 |    781 batches | lr 0.00019 | ms/batch 450.80 | loss  2.78 | ppl    16.175
| epoch  10 step    30600 |    981 batches | lr 0.000191 | ms/batch 450.81 | loss  2.80 | ppl    16.403
| epoch  10 step    30800 |   1181 batches | lr 0.000193 | ms/batch 450.92 | loss  2.82 | ppl    16.745
| epoch  10 step    31000 |   1381 batches | lr 0.000194 | ms/batch 450.78 | loss  2.82 | ppl    16.827
| epoch  10 step    31200 |   1581 batches | lr 0.000195 | ms/batch 450.91 | loss  2.84 | ppl    17.112
| epoch  10 step    31400 |   1781 batches | lr 0.000196 | ms/batch 451.15 | loss  2.85 | ppl    17.282
| epoch  10 step    31600 |   1981 batches | lr 0.000198 | ms/batch 451.10 | loss  2.86 | ppl    17.402
| epoch  10 step    31800 |   2181 batches | lr 0.000199 | ms/batch 451.02 | loss  2.87 | ppl    17.591
| epoch  10 step    32000 |   2381 batches | lr 0.0002 | ms/batch 450.96 | loss  2.88 | ppl    17.738
----------------------------------------------------------------------------------------------------
| Eval   8 at step    32000 | time: 1805.23s | valid loss  5.96 | valid ppl   387.314
----------------------------------------------------------------------------------------------------
| epoch  10 step    32200 |   2581 batches | lr 0.000201 | ms/batch 460.29 | loss  2.88 | ppl    17.863
| epoch  10 step    32400 |   2781 batches | lr 0.000202 | ms/batch 451.05 | loss  2.88 | ppl    17.898
| epoch  10 step    32600 |   2981 batches | lr 0.000204 | ms/batch 451.06 | loss  2.89 | ppl    18.006
| epoch  10 step    32800 |   3181 batches | lr 0.000205 | ms/batch 451.18 | loss  2.90 | ppl    18.189
| epoch  11 step    33000 |     90 batches | lr 0.000206 | ms/batch 451.00 | loss  2.78 | ppl    16.103
| epoch  11 step    33200 |    290 batches | lr 0.000208 | ms/batch 451.41 | loss  2.64 | ppl    14.064
| epoch  11 step    33400 |    490 batches | lr 0.000209 | ms/batch 450.97 | loss  2.68 | ppl    14.553
| epoch  11 step    33600 |    690 batches | lr 0.00021 | ms/batch 451.22 | loss  2.71 | ppl    15.049
| epoch  11 step    33800 |    890 batches | lr 0.000211 | ms/batch 451.11 | loss  2.73 | ppl    15.269
| epoch  11 step    34000 |   1090 batches | lr 0.000212 | ms/batch 451.12 | loss  2.74 | ppl    15.501
| epoch  11 step    34200 |   1290 batches | lr 0.000214 | ms/batch 451.19 | loss  2.76 | ppl    15.839
| epoch  11 step    34400 |   1490 batches | lr 0.000215 | ms/batch 451.29 | loss  2.77 | ppl    16.019
| epoch  11 step    34600 |   1690 batches | lr 0.000216 | ms/batch 450.91 | loss  2.79 | ppl    16.226
| epoch  11 step    34800 |   1890 batches | lr 0.000218 | ms/batch 450.78 | loss  2.80 | ppl    16.437
| epoch  11 step    35000 |   2090 batches | lr 0.000219 | ms/batch 450.93 | loss  2.80 | ppl    16.512
| epoch  11 step    35200 |   2290 batches | lr 0.00022 | ms/batch 451.25 | loss  2.82 | ppl    16.788
| epoch  11 step    35400 |   2490 batches | lr 0.000221 | ms/batch 451.18 | loss  2.83 | ppl    16.871
| epoch  11 step    35600 |   2690 batches | lr 0.000223 | ms/batch 450.71 | loss  2.84 | ppl    17.090
| epoch  11 step    35800 |   2890 batches | lr 0.000224 | ms/batch 450.46 | loss  2.85 | ppl    17.259
| epoch  11 step    36000 |   3090 batches | lr 0.000225 | ms/batch 450.77 | loss  2.85 | ppl    17.354
----------------------------------------------------------------------------------------------------
| Eval   9 at step    36000 | time: 1805.99s | valid loss  6.09 | valid ppl   440.469
----------------------------------------------------------------------------------------------------
| epoch  11 step    36200 |   3290 batches | lr 0.000226 | ms/batch 459.84 | loss  2.86 | ppl    17.468
| epoch  12 step    36400 |    199 batches | lr 0.000228 | ms/batch 450.63 | loss  2.59 | ppl    13.295
| epoch  12 step    36600 |    399 batches | lr 0.000229 | ms/batch 450.99 | loss  2.62 | ppl    13.701
| epoch  12 step    36800 |    599 batches | lr 0.00023 | ms/batch 450.77 | loss  2.64 | ppl    14.082
| epoch  12 step    37000 |    799 batches | lr 0.000231 | ms/batch 450.96 | loss  2.68 | ppl    14.610
| epoch  12 step    37200 |    999 batches | lr 0.000233 | ms/batch 450.97 | loss  2.70 | ppl    14.832
| epoch  12 step    37400 |   1199 batches | lr 0.000234 | ms/batch 450.91 | loss  2.72 | ppl    15.156
| epoch  12 step    37600 |   1399 batches | lr 0.000235 | ms/batch 450.91 | loss  2.74 | ppl    15.485
| epoch  12 step    37800 |   1599 batches | lr 0.000236 | ms/batch 451.05 | loss  2.76 | ppl    15.725
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
slurmstepd: error: *** JOB 44270119 ON gpu37 CANCELLED AT 2019-08-18T17:48:22 ***
slurmstepd: error: *** STEP 44270119.0 ON gpu37 CANCELLED AT 2019-08-18T17:48:22 ***
Job has already finished for job 44270119
Job has already finished for job 44270119
