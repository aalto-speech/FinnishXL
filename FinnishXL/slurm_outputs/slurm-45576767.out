Run training...
Experiment dir : /m/triton/scratch/elec/puhe/p/jaina5/transformer-xl/FinnishXL/-Ktrain/20190923-123237
Loading cached dataset...
====================================================================================================
    - data : /m/triton/scratch/elec/puhe/p/jaina5/transformer-xl/FinnishXL/data/kiel_data/
    - dataset : Ktrain
    - n_layer : 96
    - n_head : 8
    - d_head : 40
    - d_embed : 256
    - d_model : 256
    - d_inner : 1024
    - dropout : 0.05
    - dropatt : 0.05
    - init : normal
    - emb_init : normal
    - init_range : 0.1
    - emb_init_range : 0.01
    - init_std : 0.02
    - proj_init_std : 0.01
    - optim : adam
    - lr : 0.00025
    - mom : 0.0
    - scheduler : cosine
    - warmup_step : 0
    - decay_rate : 0.5
    - lr_min : 0.0
    - clip : 0.25
    - clip_nonemb : False
    - max_step : 200000
    - batch_size : 512
    - batch_chunk : 4
    - tgt_len : 32
    - eval_tgt_len : 32
    - ext_len : 0
    - mem_len : 32
    - not_tied : False
    - seed : 1111
    - cuda : True
    - adaptive : False
    - div_val : 1
    - pre_lnorm : False
    - varlen : False
    - multi_gpu : False
    - log_interval : 200
    - eval_interval : 4000
    - work_dir : /m/triton/scratch/elec/puhe/p/jaina5/transformer-xl/FinnishXL/-Ktrain/20190923-123237
    - restart : True
    - restart_dir : /m/triton/scratch/elec/puhe/p/jaina5/transformer-xl/FinnishXL/-Ktrain/20190913-122106
    - debug : False
    - same_length : False
    - attn_type : 0
    - clamp_len : -1
    - eta_min : 0.0
    - gpu0_bsz : -1
    - max_eval_steps : -1
    - sample_softmax : -1
    - patience : 0
    - finetune_v2 : False
    - finetune_v3 : False
    - fp16 : False
    - static_loss_scale : 1
    - dynamic_loss_scale : False
    - tied : True
    - n_token : 34519
    - n_all_param : 98746455
    - n_nonemb_param : 89874432
====================================================================================================
#params = 98746455
#non emb params = 89874432
| epoch   1 step   157000 |    200 batches | lr 2.74e-05 | ms/batch 2645.91 | loss  3.84 | ppl    46.361
| epoch   1 step   157200 |    400 batches | lr 2.72e-05 | ms/batch 2640.63 | loss  3.84 | ppl    46.501
| epoch   1 step   157400 |    600 batches | lr 2.7e-05 | ms/batch 2640.31 | loss  3.84 | ppl    46.628
| epoch   1 step   157600 |    800 batches | lr 2.67e-05 | ms/batch 2640.43 | loss  3.84 | ppl    46.459
| epoch   1 step   157800 |   1000 batches | lr 2.65e-05 | ms/batch 2641.00 | loss  3.84 | ppl    46.703
| epoch   1 step   158000 |   1200 batches | lr 2.62e-05 | ms/batch 2640.50 | loss  3.84 | ppl    46.510
| epoch   1 step   158200 |   1400 batches | lr 2.6e-05 | ms/batch 2640.59 | loss  3.84 | ppl    46.662
| epoch   1 step   158400 |   1600 batches | lr 2.58e-05 | ms/batch 2640.78 | loss  3.85 | ppl    46.790
| epoch   1 step   158600 |   1800 batches | lr 2.55e-05 | ms/batch 2641.02 | loss  3.85 | ppl    46.794
| epoch   1 step   158800 |   2000 batches | lr 2.53e-05 | ms/batch 2640.40 | loss  3.85 | ppl    46.799
| epoch   1 step   159000 |   2200 batches | lr 2.5e-05 | ms/batch 2640.89 | loss  3.84 | ppl    46.596
| epoch   1 step   159200 |   2400 batches | lr 2.48e-05 | ms/batch 2640.78 | loss  3.85 | ppl    46.790
| epoch   1 step   159400 |   2600 batches | lr 2.46e-05 | ms/batch 2641.22 | loss  3.85 | ppl    46.944
| epoch   1 step   159600 |   2800 batches | lr 2.43e-05 | ms/batch 2640.81 | loss  3.85 | ppl    46.787
| epoch   1 step   159800 |   3000 batches | lr 2.41e-05 | ms/batch 2641.25 | loss  3.84 | ppl    46.679
| epoch   1 step   160000 |   3200 batches | lr 2.39e-05 | ms/batch 2641.08 | loss  3.85 | ppl    46.838
----------------------------------------------------------------------------------------------------
| Eval  40 at step   160000 | time: 9170.77s | valid loss  3.83 | valid ppl    45.984
----------------------------------------------------------------------------------------------------
| epoch   1 step   160200 |   3400 batches | lr 2.36e-05 | ms/batch 6248.02 | loss  3.85 | ppl    46.976
| epoch   1 step   160400 |   3600 batches | lr 2.34e-05 | ms/batch 2642.53 | loss  3.84 | ppl    46.637
| epoch   1 step   160600 |   3800 batches | lr 2.32e-05 | ms/batch 2642.95 | loss  3.85 | ppl    46.785
| epoch   1 step   160800 |   4000 batches | lr 2.3e-05 | ms/batch 2643.25 | loss  3.84 | ppl    46.689
| epoch   1 step   161000 |   4200 batches | lr 2.27e-05 | ms/batch 2642.91 | loss  3.84 | ppl    46.591
| epoch   1 step   161200 |   4400 batches | lr 2.25e-05 | ms/batch 2643.57 | loss  3.85 | ppl    46.854
| epoch   1 step   161400 |   4600 batches | lr 2.23e-05 | ms/batch 2643.41 | loss  3.85 | ppl    46.994
| epoch   1 step   161600 |   4800 batches | lr 2.21e-05 | ms/batch 2643.02 | loss  3.85 | ppl    46.765
| epoch   1 step   161800 |   5000 batches | lr 2.18e-05 | ms/batch 2642.92 | loss  3.84 | ppl    46.560
| epoch   1 step   162000 |   5200 batches | lr 2.16e-05 | ms/batch 2642.55 | loss  3.84 | ppl    46.606
| epoch   1 step   162200 |   5400 batches | lr 2.14e-05 | ms/batch 2642.50 | loss  3.84 | ppl    46.618
| epoch   1 step   162400 |   5600 batches | lr 2.12e-05 | ms/batch 2642.38 | loss  3.84 | ppl    46.686
| epoch   1 step   162600 |   5800 batches | lr 2.1e-05 | ms/batch 2642.70 | loss  3.84 | ppl    46.609
| epoch   1 step   162800 |   6000 batches | lr 2.07e-05 | ms/batch 2642.04 | loss  3.85 | ppl    46.826
| epoch   1 step   163000 |   6200 batches | lr 2.05e-05 | ms/batch 2642.03 | loss  3.84 | ppl    46.748
| epoch   1 step   163200 |   6400 batches | lr 2.03e-05 | ms/batch 2642.34 | loss  3.84 | ppl    46.582
| epoch   1 step   163400 |   6600 batches | lr 2.01e-05 | ms/batch 2642.27 | loss  3.85 | ppl    46.809
| epoch   1 step   163600 |   6800 batches | lr 1.99e-05 | ms/batch 2641.66 | loss  3.85 | ppl    46.796
| epoch   1 step   163800 |   7000 batches | lr 1.97e-05 | ms/batch 2641.87 | loss  3.84 | ppl    46.611
| epoch   1 step   164000 |   7200 batches | lr 1.95e-05 | ms/batch 2642.11 | loss  3.84 | ppl    46.396
----------------------------------------------------------------------------------------------------
| Eval  41 at step   164000 | time: 11295.64s | valid loss  3.82 | valid ppl    45.807
----------------------------------------------------------------------------------------------------
| epoch   1 step   164200 |   7400 batches | lr 1.92e-05 | ms/batch 6276.55 | loss  3.84 | ppl    46.586
| epoch   1 step   164400 |   7600 batches | lr 1.9e-05 | ms/batch 2642.34 | loss  3.85 | ppl    46.800
| epoch   1 step   164600 |   7800 batches | lr 1.88e-05 | ms/batch 2641.97 | loss  3.84 | ppl    46.638
| epoch   1 step   164800 |   8000 batches | lr 1.86e-05 | ms/batch 2641.01 | loss  3.84 | ppl    46.582
| epoch   1 step   165000 |   8200 batches | lr 1.84e-05 | ms/batch 2640.66 | loss  3.84 | ppl    46.682
| epoch   1 step   165200 |   8400 batches | lr 1.82e-05 | ms/batch 2641.36 | loss  3.85 | ppl    46.793
| epoch   1 step   165400 |   8600 batches | lr 1.8e-05 | ms/batch 2641.01 | loss  3.84 | ppl    46.602
| epoch   1 step   165600 |   8800 batches | lr 1.78e-05 | ms/batch 2640.49 | loss  3.84 | ppl    46.468
| epoch   1 step   165800 |   9000 batches | lr 1.76e-05 | ms/batch 2640.57 | loss  3.84 | ppl    46.333
| epoch   1 step   166000 |   9200 batches | lr 1.74e-05 | ms/batch 2640.65 | loss  3.84 | ppl    46.716
| epoch   1 step   166200 |   9400 batches | lr 1.72e-05 | ms/batch 2640.43 | loss  3.84 | ppl    46.730
| epoch   1 step   166400 |   9600 batches | lr 1.7e-05 | ms/batch 2640.05 | loss  3.84 | ppl    46.571
| epoch   1 step   166600 |   9800 batches | lr 1.68e-05 | ms/batch 2639.24 | loss  3.84 | ppl    46.678
| epoch   1 step   166800 |  10000 batches | lr 1.66e-05 | ms/batch 2639.04 | loss  3.84 | ppl    46.527
| epoch   1 step   167000 |  10200 batches | lr 1.64e-05 | ms/batch 2638.83 | loss  3.84 | ppl    46.701
| epoch   1 step   167200 |  10400 batches | lr 1.62e-05 | ms/batch 2638.68 | loss  3.84 | ppl    46.644
| epoch   1 step   167400 |  10600 batches | lr 1.6e-05 | ms/batch 2639.10 | loss  3.84 | ppl    46.539
| epoch   1 step   167600 |  10800 batches | lr 1.58e-05 | ms/batch 2638.83 | loss  3.84 | ppl    46.591
| epoch   1 step   167800 |  11000 batches | lr 1.57e-05 | ms/batch 2639.27 | loss  3.85 | ppl    47.010
| epoch   1 step   168000 |  11200 batches | lr 1.55e-05 | ms/batch 2638.42 | loss  3.84 | ppl    46.365
----------------------------------------------------------------------------------------------------
| Eval  42 at step   168000 | time: 11268.74s | valid loss  3.82 | valid ppl    45.641
----------------------------------------------------------------------------------------------------
| epoch   1 step   168200 |  11400 batches | lr 1.53e-05 | ms/batch 6187.65 | loss  3.85 | ppl    46.773
| epoch   1 step   168400 |  11600 batches | lr 1.51e-05 | ms/batch 2638.56 | loss  3.84 | ppl    46.353
| epoch   1 step   168600 |  11800 batches | lr 1.49e-05 | ms/batch 2638.86 | loss  3.84 | ppl    46.527
| epoch   1 step   168800 |  12000 batches | lr 1.47e-05 | ms/batch 2639.19 | loss  3.84 | ppl    46.702
| epoch   1 step   169000 |  12200 batches | lr 1.45e-05 | ms/batch 2638.72 | loss  3.84 | ppl    46.620
| epoch   1 step   169200 |  12400 batches | lr 1.43e-05 | ms/batch 2639.37 | loss  3.84 | ppl    46.754
| epoch   1 step   169400 |  12600 batches | lr 1.42e-05 | ms/batch 2639.34 | loss  3.84 | ppl    46.570
| epoch   1 step   169600 |  12800 batches | lr 1.4e-05 | ms/batch 2639.13 | loss  3.85 | ppl    46.965
| epoch   1 step   169800 |  13000 batches | lr 1.38e-05 | ms/batch 2638.62 | loss  3.84 | ppl    46.342
| epoch   1 step   170000 |  13200 batches | lr 1.36e-05 | ms/batch 2639.02 | loss  3.84 | ppl    46.389
| epoch   1 step   170200 |  13400 batches | lr 1.34e-05 | ms/batch 2638.50 | loss  3.84 | ppl    46.556
| epoch   1 step   170400 |  13600 batches | lr 1.33e-05 | ms/batch 2639.02 | loss  3.84 | ppl    46.695
| epoch   1 step   170600 |  13800 batches | lr 1.31e-05 | ms/batch 2639.08 | loss  3.84 | ppl    46.632
| epoch   1 step   170800 |  14000 batches | lr 1.29e-05 | ms/batch 2638.97 | loss  3.84 | ppl    46.724
| epoch   1 step   171000 |  14200 batches | lr 1.27e-05 | ms/batch 2639.07 | loss  3.84 | ppl    46.536
| epoch   1 step   171200 |  14400 batches | lr 1.26e-05 | ms/batch 2638.86 | loss  3.84 | ppl    46.727
| epoch   1 step   171400 |  14600 batches | lr 1.24e-05 | ms/batch 2638.85 | loss  3.84 | ppl    46.574
| epoch   1 step   171600 |  14800 batches | lr 1.22e-05 | ms/batch 2639.31 | loss  3.84 | ppl    46.629
| epoch   1 step   171800 |  15000 batches | lr 1.21e-05 | ms/batch 2639.05 | loss  3.84 | ppl    46.622
| epoch   2 step   172000 |     85 batches | lr 1.19e-05 | ms/batch 2640.19 | loss  3.84 | ppl    46.361
----------------------------------------------------------------------------------------------------
| Eval  43 at step   172000 | time: 11267.34s | valid loss  3.82 | valid ppl    45.506
----------------------------------------------------------------------------------------------------
| epoch   2 step   172200 |    285 batches | lr 1.17e-05 | ms/batch 6204.43 | loss  3.82 | ppl    45.537
| epoch   2 step   172400 |    485 batches | lr 1.16e-05 | ms/batch 2638.46 | loss  3.82 | ppl    45.585
| epoch   2 step   172600 |    685 batches | lr 1.14e-05 | ms/batch 2639.31 | loss  3.83 | ppl    46.004
| epoch   2 step   172800 |    885 batches | lr 1.12e-05 | ms/batch 2638.75 | loss  3.82 | ppl    45.630
| epoch   2 step   173000 |   1085 batches | lr 1.11e-05 | ms/batch 2639.39 | loss  3.82 | ppl    45.809
| epoch   2 step   173200 |   1285 batches | lr 1.09e-05 | ms/batch 2639.51 | loss  3.82 | ppl    45.736
| epoch   2 step   173400 |   1485 batches | lr 1.08e-05 | ms/batch 2638.90 | loss  3.83 | ppl    45.862
| epoch   2 step   173600 |   1685 batches | lr 1.06e-05 | ms/batch 2639.37 | loss  3.82 | ppl    45.509
| epoch   2 step   173800 |   1885 batches | lr 1.04e-05 | ms/batch 2638.87 | loss  3.82 | ppl    45.719
| epoch   2 step   174000 |   2085 batches | lr 1.03e-05 | ms/batch 2639.07 | loss  3.83 | ppl    45.949
| epoch   2 step   174200 |   2285 batches | lr 1.01e-05 | ms/batch 2639.40 | loss  3.83 | ppl    45.851
| epoch   2 step   174400 |   2485 batches | lr 9.97e-06 | ms/batch 2638.76 | loss  3.83 | ppl    45.970
| epoch   2 step   174600 |   2685 batches | lr 9.82e-06 | ms/batch 2639.11 | loss  3.82 | ppl    45.659
| epoch   2 step   174800 |   2885 batches | lr 9.67e-06 | ms/batch 2638.64 | loss  3.82 | ppl    45.619
| epoch   2 step   175000 |   3085 batches | lr 9.52e-06 | ms/batch 2639.15 | loss  3.83 | ppl    45.993
| epoch   2 step   175200 |   3285 batches | lr 9.37e-06 | ms/batch 2639.15 | loss  3.83 | ppl    45.848
| epoch   2 step   175400 |   3485 batches | lr 9.22e-06 | ms/batch 2639.42 | loss  3.83 | ppl    46.053
| epoch   2 step   175600 |   3685 batches | lr 9.07e-06 | ms/batch 2639.32 | loss  3.83 | ppl    45.879
| epoch   2 step   175800 |   3885 batches | lr 8.92e-06 | ms/batch 2639.51 | loss  3.83 | ppl    45.857
| epoch   2 step   176000 |   4085 batches | lr 8.78e-06 | ms/batch 2639.15 | loss  3.83 | ppl    45.911
----------------------------------------------------------------------------------------------------
| Eval  44 at step   176000 | time: 11264.29s | valid loss  3.82 | valid ppl    45.428
----------------------------------------------------------------------------------------------------
| epoch   2 step   176200 |   4285 batches | lr 8.63e-06 | ms/batch 6187.13 | loss  3.83 | ppl    45.936
| epoch   2 step   176400 |   4485 batches | lr 8.49e-06 | ms/batch 2639.21 | loss  3.83 | ppl    45.908
| epoch   2 step   176600 |   4685 batches | lr 8.35e-06 | ms/batch 2639.83 | loss  3.83 | ppl    45.856
| epoch   2 step   176800 |   4885 batches | lr 8.21e-06 | ms/batch 2639.26 | loss  3.82 | ppl    45.659
| epoch   2 step   177000 |   5085 batches | lr 8.07e-06 | ms/batch 2639.34 | loss  3.83 | ppl    45.937
| epoch   2 step   177200 |   5285 batches | lr 7.93e-06 | ms/batch 2639.19 | loss  3.83 | ppl    46.097
| epoch   2 step   177400 |   5485 batches | lr 7.79e-06 | ms/batch 2639.07 | loss  3.83 | ppl    45.891
| epoch   2 step   177600 |   5685 batches | lr 7.66e-06 | ms/batch 2639.01 | loss  3.83 | ppl    46.067
| epoch   2 step   177800 |   5885 batches | lr 7.52e-06 | ms/batch 2638.87 | loss  3.82 | ppl    45.689
| epoch   2 step   178000 |   6085 batches | lr 7.39e-06 | ms/batch 2639.02 | loss  3.83 | ppl    46.060
| epoch   2 step   178200 |   6285 batches | lr 7.26e-06 | ms/batch 2639.08 | loss  3.83 | ppl    45.900
| epoch   2 step   178400 |   6485 batches | lr 7.13e-06 | ms/batch 2639.66 | loss  3.83 | ppl    45.833
| epoch   2 step   178600 |   6685 batches | lr 7e-06 | ms/batch 2639.27 | loss  3.82 | ppl    45.709
| epoch   2 step   178800 |   6885 batches | lr 6.87e-06 | ms/batch 2639.25 | loss  3.82 | ppl    45.797
| epoch   2 step   179000 |   7085 batches | lr 6.74e-06 | ms/batch 2639.47 | loss  3.83 | ppl    46.239
| epoch   2 step   179200 |   7285 batches | lr 6.61e-06 | ms/batch 2639.30 | loss  3.83 | ppl    46.208
| epoch   2 step   179400 |   7485 batches | lr 6.49e-06 | ms/batch 2639.43 | loss  3.83 | ppl    46.005
| epoch   2 step   179600 |   7685 batches | lr 6.36e-06 | ms/batch 2637.96 | loss  3.82 | ppl    45.663
| epoch   2 step   179800 |   7885 batches | lr 6.24e-06 | ms/batch 2637.87 | loss  3.82 | ppl    45.791
| epoch   2 step   180000 |   8085 batches | lr 6.12e-06 | ms/batch 2637.87 | loss  3.82 | ppl    45.806
----------------------------------------------------------------------------------------------------
| Eval  45 at step   180000 | time: 11262.96s | valid loss  3.81 | valid ppl    45.360
----------------------------------------------------------------------------------------------------
| epoch   2 step   180200 |   8285 batches | lr 6e-06 | ms/batch 6181.20 | loss  3.82 | ppl    45.505
| epoch   2 step   180400 |   8485 batches | lr 5.88e-06 | ms/batch 2637.67 | loss  3.83 | ppl    45.889
| epoch   2 step   180600 |   8685 batches | lr 5.76e-06 | ms/batch 2637.58 | loss  3.83 | ppl    45.873
| epoch   2 step   180800 |   8885 batches | lr 5.64e-06 | ms/batch 2638.07 | loss  3.82 | ppl    45.592
| epoch   2 step   181000 |   9085 batches | lr 5.53e-06 | ms/batch 2638.01 | loss  3.83 | ppl    45.913
| epoch   2 step   181200 |   9285 batches | lr 5.41e-06 | ms/batch 2638.02 | loss  3.83 | ppl    45.906
| epoch   2 step   181400 |   9485 batches | lr 5.3e-06 | ms/batch 2637.79 | loss  3.82 | ppl    45.602
| epoch   2 step   181600 |   9685 batches | lr 5.18e-06 | ms/batch 2637.52 | loss  3.82 | ppl    45.708
| epoch   2 step   181800 |   9885 batches | lr 5.07e-06 | ms/batch 2637.83 | loss  3.82 | ppl    45.554
| epoch   2 step   182000 |  10085 batches | lr 4.96e-06 | ms/batch 2638.13 | loss  3.82 | ppl    45.612
| epoch   2 step   182200 |  10285 batches | lr 4.85e-06 | ms/batch 2638.00 | loss  3.83 | ppl    45.910
| epoch   2 step   182400 |  10485 batches | lr 4.75e-06 | ms/batch 2637.99 | loss  3.82 | ppl    45.548
| epoch   2 step   182600 |  10685 batches | lr 4.64e-06 | ms/batch 2637.84 | loss  3.83 | ppl    45.860
| epoch   2 step   182800 |  10885 batches | lr 4.53e-06 | ms/batch 2637.96 | loss  3.82 | ppl    45.790
| epoch   2 step   183000 |  11085 batches | lr 4.43e-06 | ms/batch 2638.07 | loss  3.82 | ppl    45.781
| epoch   2 step   183200 |  11285 batches | lr 4.33e-06 | ms/batch 2638.15 | loss  3.82 | ppl    45.586
| epoch   2 step   183400 |  11485 batches | lr 4.23e-06 | ms/batch 2638.30 | loss  3.82 | ppl    45.589
| epoch   2 step   183600 |  11685 batches | lr 4.12e-06 | ms/batch 2637.79 | loss  3.82 | ppl    45.732
| epoch   2 step   183800 |  11885 batches | lr 4.03e-06 | ms/batch 2637.86 | loss  3.83 | ppl    45.833
| epoch   2 step   184000 |  12085 batches | lr 3.93e-06 | ms/batch 2637.85 | loss  3.83 | ppl    45.835
----------------------------------------------------------------------------------------------------
| Eval  46 at step   184000 | time: 11259.79s | valid loss  3.81 | valid ppl    45.299
----------------------------------------------------------------------------------------------------
| epoch   2 step   184200 |  12285 batches | lr 3.83e-06 | ms/batch 6187.53 | loss  3.82 | ppl    45.597
| epoch   2 step   184400 |  12485 batches | lr 3.73e-06 | ms/batch 2638.37 | loss  3.82 | ppl    45.693
| epoch   2 step   184600 |  12685 batches | lr 3.64e-06 | ms/batch 2637.80 | loss  3.83 | ppl    45.899
| epoch   2 step   184800 |  12885 batches | lr 3.55e-06 | ms/batch 2638.24 | loss  3.82 | ppl    45.696
| epoch   2 step   185000 |  13085 batches | lr 3.45e-06 | ms/batch 2638.40 | loss  3.83 | ppl    45.986
| epoch   2 step   185200 |  13285 batches | lr 3.36e-06 | ms/batch 2638.31 | loss  3.83 | ppl    45.884
| epoch   2 step   185400 |  13485 batches | lr 3.27e-06 | ms/batch 2637.81 | loss  3.83 | ppl    45.897
| epoch   2 step   185600 |  13685 batches | lr 3.18e-06 | ms/batch 2638.11 | loss  3.82 | ppl    45.782
| epoch   2 step   185800 |  13885 batches | lr 3.1e-06 | ms/batch 2638.08 | loss  3.82 | ppl    45.791
| epoch   2 step   186000 |  14085 batches | lr 3.01e-06 | ms/batch 2637.85 | loss  3.83 | ppl    45.928
| epoch   2 step   186200 |  14285 batches | lr 2.93e-06 | ms/batch 2638.10 | loss  3.82 | ppl    45.830
| epoch   2 step   186400 |  14485 batches | lr 2.84e-06 | ms/batch 2637.94 | loss  3.83 | ppl    45.995
| epoch   2 step   186600 |  14685 batches | lr 2.76e-06 | ms/batch 2637.85 | loss  3.82 | ppl    45.687
| epoch   2 step   186800 |  14885 batches | lr 2.68e-06 | ms/batch 2637.58 | loss  3.82 | ppl    45.683
| epoch   2 step   187000 |  15085 batches | lr 2.6e-06 | ms/batch 2637.87 | loss  3.83 | ppl    45.907
| epoch   3 step   187200 |    170 batches | lr 2.52e-06 | ms/batch 2639.09 | loss  3.82 | ppl    45.434
| epoch   3 step   187400 |    370 batches | lr 2.44e-06 | ms/batch 2638.45 | loss  3.81 | ppl    45.369
| epoch   3 step   187600 |    570 batches | lr 2.36e-06 | ms/batch 2638.13 | loss  3.81 | ppl    45.269
| epoch   3 step   187800 |    770 batches | lr 2.29e-06 | ms/batch 2638.38 | loss  3.82 | ppl    45.754
| epoch   3 step   188000 |    970 batches | lr 2.21e-06 | ms/batch 2638.45 | loss  3.81 | ppl    45.337
----------------------------------------------------------------------------------------------------
| Eval  47 at step   188000 | time: 11262.04s | valid loss  3.81 | valid ppl    45.265
----------------------------------------------------------------------------------------------------
| epoch   3 step   188200 |   1170 batches | lr 2.14e-06 | ms/batch 6194.67 | loss  3.81 | ppl    45.273
| epoch   3 step   188400 |   1370 batches | lr 2.07e-06 | ms/batch 2638.76 | loss  3.82 | ppl    45.456
| epoch   3 step   188600 |   1570 batches | lr 2e-06 | ms/batch 2638.19 | loss  3.82 | ppl    45.506
| epoch   3 step   188800 |   1770 batches | lr 1.93e-06 | ms/batch 2638.33 | loss  3.82 | ppl    45.453
| epoch   3 step   189000 |   1970 batches | lr 1.86e-06 | ms/batch 2637.88 | loss  3.82 | ppl    45.569
| epoch   3 step   189200 |   2170 batches | lr 1.79e-06 | ms/batch 2640.09 | loss  3.81 | ppl    45.180
| epoch   3 step   189400 |   2370 batches | lr 1.73e-06 | ms/batch 2640.15 | loss  3.81 | ppl    45.191
| epoch   3 step   189600 |   2570 batches | lr 1.66e-06 | ms/batch 2639.47 | loss  3.82 | ppl    45.623
| epoch   3 step   189800 |   2770 batches | lr 1.6e-06 | ms/batch 2639.05 | loss  3.82 | ppl    45.419
| epoch   3 step   190000 |   2970 batches | lr 1.54e-06 | ms/batch 2639.03 | loss  3.82 | ppl    45.442
| epoch   3 step   190200 |   3170 batches | lr 1.48e-06 | ms/batch 2639.16 | loss  3.82 | ppl    45.420
| epoch   3 step   190400 |   3370 batches | lr 1.42e-06 | ms/batch 2639.32 | loss  3.82 | ppl    45.504
| epoch   3 step   190600 |   3570 batches | lr 1.36e-06 | ms/batch 2638.95 | loss  3.82 | ppl    45.422
| epoch   3 step   190800 |   3770 batches | lr 1.3e-06 | ms/batch 2639.37 | loss  3.81 | ppl    45.278
| epoch   3 step   191000 |   3970 batches | lr 1.25e-06 | ms/batch 2639.26 | loss  3.82 | ppl    45.409
| epoch   3 step   191200 |   4170 batches | lr 1.19e-06 | ms/batch 2639.38 | loss  3.82 | ppl    45.480
| epoch   3 step   191400 |   4370 batches | lr 1.14e-06 | ms/batch 2639.39 | loss  3.82 | ppl    45.534
| epoch   3 step   191600 |   4570 batches | lr 1.09e-06 | ms/batch 2639.44 | loss  3.81 | ppl    45.267
| epoch   3 step   191800 |   4770 batches | lr 1.04e-06 | ms/batch 2639.34 | loss  3.81 | ppl    45.289
| epoch   3 step   192000 |   4970 batches | lr 9.86e-07 | ms/batch 2639.20 | loss  3.81 | ppl    45.296
----------------------------------------------------------------------------------------------------
| Eval  48 at step   192000 | time: 11263.73s | valid loss  3.81 | valid ppl    45.247
----------------------------------------------------------------------------------------------------
| epoch   3 step   192200 |   5170 batches | lr 9.37e-07 | ms/batch 6184.99 | loss  3.82 | ppl    45.382
| epoch   3 step   192400 |   5370 batches | lr 8.9e-07 | ms/batch 2639.43 | loss  3.81 | ppl    45.197
| epoch   3 step   192600 |   5570 batches | lr 8.44e-07 | ms/batch 2639.04 | loss  3.81 | ppl    45.360
| epoch   3 step   192800 |   5770 batches | lr 7.99e-07 | ms/batch 2639.36 | loss  3.81 | ppl    45.262
| epoch   3 step   193000 |   5970 batches | lr 7.55e-07 | ms/batch 2639.48 | loss  3.82 | ppl    45.396
| epoch   3 step   193200 |   6170 batches | lr 7.12e-07 | ms/batch 2638.99 | loss  3.81 | ppl    45.180
| epoch   3 step   193400 |   6370 batches | lr 6.71e-07 | ms/batch 2639.07 | loss  3.82 | ppl    45.434
| epoch   3 step   193600 |   6570 batches | lr 6.31e-07 | ms/batch 2639.36 | loss  3.82 | ppl    45.391
| epoch   3 step   193800 |   6770 batches | lr 5.92e-07 | ms/batch 2639.59 | loss  3.82 | ppl    45.524
| epoch   3 step   194000 |   6970 batches | lr 5.55e-07 | ms/batch 2639.49 | loss  3.82 | ppl    45.562
| epoch   3 step   194200 |   7170 batches | lr 5.18e-07 | ms/batch 2639.04 | loss  3.81 | ppl    45.289
| epoch   3 step   194400 |   7370 batches | lr 4.83e-07 | ms/batch 2639.30 | loss  3.82 | ppl    45.659
| epoch   3 step   194600 |   7570 batches | lr 4.49e-07 | ms/batch 2639.16 | loss  3.81 | ppl    45.205
| epoch   3 step   194800 |   7770 batches | lr 4.17e-07 | ms/batch 2639.48 | loss  3.81 | ppl    45.367
| epoch   3 step   195000 |   7970 batches | lr 3.85e-07 | ms/batch 2639.47 | loss  3.82 | ppl    45.591
| epoch   3 step   195200 |   8170 batches | lr 3.55e-07 | ms/batch 2639.27 | loss  3.81 | ppl    45.089
| epoch   3 step   195400 |   8370 batches | lr 3.26e-07 | ms/batch 2639.66 | loss  3.81 | ppl    45.344
| epoch   3 step   195600 |   8570 batches | lr 2.98e-07 | ms/batch 2639.98 | loss  3.82 | ppl    45.432
| epoch   3 step   195800 |   8770 batches | lr 2.72e-07 | ms/batch 2639.41 | loss  3.82 | ppl    45.401
| epoch   3 step   196000 |   8970 batches | lr 2.47e-07 | ms/batch 2638.91 | loss  3.82 | ppl    45.483
----------------------------------------------------------------------------------------------------
| Eval  49 at step   196000 | time: 11266.21s | valid loss  3.81 | valid ppl    45.236
----------------------------------------------------------------------------------------------------
| epoch   3 step   196200 |   9170 batches | lr 2.23e-07 | ms/batch 6192.33 | loss  3.81 | ppl    45.367
| epoch   3 step   196400 |   9370 batches | lr 2e-07 | ms/batch 2639.41 | loss  3.81 | ppl    45.341
| epoch   3 step   196600 |   9570 batches | lr 1.78e-07 | ms/batch 2640.05 | loss  3.81 | ppl    45.337
| epoch   3 step   196800 |   9770 batches | lr 1.58e-07 | ms/batch 2639.54 | loss  3.81 | ppl    45.032
| epoch   3 step   197000 |   9970 batches | lr 1.39e-07 | ms/batch 2638.80 | loss  3.81 | ppl    45.176
| epoch   3 step   197200 |  10170 batches | lr 1.21e-07 | ms/batch 2639.23 | loss  3.82 | ppl    45.582
| epoch   3 step   197400 |  10370 batches | lr 1.04e-07 | ms/batch 2639.49 | loss  3.81 | ppl    45.073
| epoch   3 step   197600 |  10570 batches | lr 8.88e-08 | ms/batch 2639.20 | loss  3.81 | ppl    45.004
| epoch   3 step   197800 |  10770 batches | lr 7.46e-08 | ms/batch 2638.96 | loss  3.82 | ppl    45.394
| epoch   3 step   198000 |  10970 batches | lr 6.17e-08 | ms/batch 2628.55 | loss  3.81 | ppl    45.199
| epoch   3 step   198200 |  11170 batches | lr 5e-08 | ms/batch 2628.08 | loss  3.82 | ppl    45.463
| epoch   3 step   198400 |  11370 batches | lr 3.95e-08 | ms/batch 2627.94 | loss  3.82 | ppl    45.461
| epoch   3 step   198600 |  11570 batches | lr 3.02e-08 | ms/batch 2628.27 | loss  3.82 | ppl    45.749
| epoch   3 step   198800 |  11770 batches | lr 2.22e-08 | ms/batch 2627.80 | loss  3.82 | ppl    45.493
| epoch   3 step   199000 |  11970 batches | lr 1.54e-08 | ms/batch 2627.83 | loss  3.82 | ppl    45.397
| epoch   3 step   199200 |  12170 batches | lr 9.87e-09 | ms/batch 2627.91 | loss  3.81 | ppl    45.186
| epoch   3 step   199400 |  12370 batches | lr 5.55e-09 | ms/batch 2627.95 | loss  3.81 | ppl    45.200
| epoch   3 step   199600 |  12570 batches | lr 2.47e-09 | ms/batch 2627.94 | loss  3.82 | ppl    45.536
| epoch   3 step   199800 |  12770 batches | lr 6.17e-10 | ms/batch 2626.79 | loss  3.82 | ppl    45.406
| epoch   3 step   200000 |  12970 batches | lr 0 | ms/batch 2626.48 | loss  3.82 | ppl    45.423
----------------------------------------------------------------------------------------------------
| Eval  50 at step   200000 | time: 11205.62s | valid loss  3.81 | valid ppl    45.235
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
End of training
====================================================================================================
| End of training | test loss  4.23 | test ppl    68.772
====================================================================================================
